(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{192:function(e,t,n){"use strict";(function(e){var a=n(80),o=n(81),i=n(82),l=n(83);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];s(this,t),App.topology=this,this.labview=$("#lab-viewport"),this.nodes={},this.networks={},this.lines={},this.textobjects={},this.labinfo={},this.links={},this.preview=e,this.loadingbar=$("#loading-lab"),this.unuseNetwork=[],this.histories=[],this.historyIndex=0}var n,c,u;return n=t,(c=[{key:"getTopoData",value:function(){var e=this;return this.loadingbar.show(),axios.request({url:"/api/labs/session/topology",method:"get",onDownloadProgress:function(e){if(e.total>0){var t=Math.round(100*e.loaded/e.total);$(".loading-lab .progress-bar").css("width",t+"%")}}}).then((function(t){e.loadingbar.hide();var n=t.data.data;return e.setData(n),"function"==typeof recoverZoomLab&&recoverZoomLab(),!0})).catch((function(t){return e.loadingbar.hide(),error_handle(t),!1}))}},{key:"setData",value:function(t){this.nodes={},this.networks={},this.lines={},this.textobjects={},this.labinfo={};var n=get(t.networks,{});for(var s in e.networks=n,n)this.networks[s]=new o.a(n[s]);var r=get(t.lines,{});for(var c in e.lines=r,r)this.lines[c]=new l.a(r[c]);var u=get(t.textObjects,{});for(var d in e.textobjects=u,u)this.textobjects[d]=new i.a(u[d]);var p=get(t.nodes,{});for(var h in e.nodes=p,p)this.nodes[h]=new a.a(p[h]);this.labinfo=get(t.labinfo,{}),e.lab=this.labinfo,e.LOCK=e.lab.lock,e.topology={networks:e.networks,nodes:e.nodes,lines:e.lines,textobjects:e.textobjects,labinfo:e.lab},this.createLinks(),this.deleteUnuseNetworks()}},{key:"updateData",value:function(t){if(t){if(isset(t.networks)){this.networks={};var n=t.networks;for(var s in e.networks=n,e.topology.networks=n,n)this.networks[s]=new o.a(n[s])}if(isset(t.nodes)){this.nodes={};var r=t.nodes;for(var c in e.nodes=r,e.topology.nodes=r,r)this.nodes[c]=new a.a(r[c])}if(isset(t.lines)){this.lines={};var u=t.lines;for(var d in e.lines=u,e.topology.lines=u,u)this.lines[d]=new l.a(u[d])}if(isset(t.textobjects)){this.textobjects={};var p=t.textobjects;for(var h in e.textobjects=p,e.topology.textobjects=p,p)this.textobjects[h]=new i.a(p[h])}isset(t.labinfo)&&(this.labinfo=t.labinfo,e.lab=this.labinfo,e.topology.lab=this.labinfo,e.LOCK=this.labinfo.lock,console.log("atat")),this.createLinks(),this.deleteUnuseNetworks()}}},{key:"deleteUnuseNetwork",value:function(e){var t=this;return axios.request({url:"/api/labs/session/networks/delete",method:"post",data:{id:e}}).then((function(e){return t.updateData(e.update),!0})).catch((function(e){return error_handle(e),!1}))}},{key:"deleteUnuseNetworks",value:function(){if(!(this.unuseNetwork.length<=0)){var e=[];for(var t in this.unuseNetwork)e.push(this.deleteUnuseNetwork(this.unuseNetwork[t]));this.unuseNetwork=[]}}},{key:"registerUnuseNetwork",value:function(e){this.unuseNetwork.push(e)}},{key:"findEndpoint",value:function(){for(var e in this.networks)this.networks[e].endpoints=[];for(var t in this.nodes){var n=this.nodes[t],a=n.get("ethernets",{});for(var o in a){var i=a[o],l=i.get("network_id");""!==l&&this.networks[l]&&this.networks[l].endpoints.push({node:n,interface:i,type:"ethernet"})}}}},{key:"createLinks",value:function(){var e=this;for(var t in this.links={},this.findEndpoint(),this.networks)this.networks[t].createLinks().map((function(t){return e.links[t.id]=t}));for(var n in this.nodes){var a=this.nodes[n],o=a.get("serials",{});for(var i in o){var l=o[i],s=l.get("remote_id");if(!(Number(s)<Number(n))){var r=l.get("remote_if");if(isset(this.nodes[s])){var c=this.nodes[s].get("serials",{})[r];if(c){var u="iface:node".concat(n,":").concat(l.get("id"));this.links[u]={source:{node:a,interface:l,type:"serial"},dest:{node:this.nodes[s],interface:c,type:"serial"},id:u}}}}}}}},{key:"applyLinkStyle",value:function(e,t){var n=e.getPaintStyle();if(isset(t.color)&&""!=t.color&&(n.stroke=t.color),isset(t.width)&&""!=t.width&&(""==t.width&&(t.width=2),(n=e.getPaintStyle()).strokeWidth=t.width),e.setPaintStyle(n),isset(t.label)){var a=$('<div class="link_label"/>');isset(t.color)&&""!=t.color&&(a.css("color",t.color),a.css("border-color",t.color)),isset(t.fontsize)&&""!=t.fontsize&&(a.css("font-size",t.fontsize+"px"),e.fontsize=t.fontsize);try{var o="",i="";t.labelpos&&""!=t.labelpos&&(null==(h=JSON.parse(t.labelpos))&&(h={}),void 0!==h.x&&void 0!==h.y&&(o="translate(".concat(h.x,"px, ").concat(h.y,"px)")),1==h.hide&&(i="label_hide"),void 0!==h.rotate&&(o+=" rotate(".concat(h.rotate,"deg)"))),""!=o&&a.css("transform",o),""!=i&&a.addClass(i)}catch(e){console.log(e)}""==t.label&&a.addClass("label_hide"),a.text(t.label),a.attr("connect_id",e.id),e.setLabel(a[0].outerHTML)}if(isset(t.style)&&""!=t.style){var l=e.getClass(),s=l.replace(/\s?border_style_([a-z]+)/g,"");s=s+" "+"border_style_".concat(t.style),e.removeClass(l),e.addClass(s)}if(isset(t.linkcfg)&&""!=t.linkcfg)try{var r=JSON.parse(t.linkcfg);e.setConnector([t.linkstyle,r]),"Flowchart"!=t.linkstyle&&"Straight"!=t.linkstyle||(e.connector.stub=r.stub),"Flowchart"==t.linkstyle&&(e.connector.midpoint=r.midpoint),"StateMachine"==t.linkstyle&&(e.connector.curviness=r.curviness)}catch(e){console.log(e)}var c=e.getOverlays();for(var u in c)if("__label"!=u){var d=c[u],p=(a=$("<div>".concat(d.getLabel(),"</div>")).text(),$('<div class="node_interface"/>'));if(!((a=a.split(":")).length<2)&&""!=a[1]){try{var h;if(o="",i="","src"==a[0])var f=t.srcpos;else f=t.dstpos;f&&""!=f&&(null==(h=JSON.parse(f))&&(h={}),void 0!==h.x&&void 0!==h.y&&(o="translate(".concat(h.x,"px, ").concat(h.y,"px)")),1==h.hide&&(i="label_hide"),void 0!==h.rotate&&(o+=" rotate(".concat(h.rotate,"deg)"))),p.text(a[1]),p.attr("position",a[0]),p.attr("connect_id",e.id),""!=o&&p.css("transform",o),""!=i&&p.addClass(i),isset(t.color)&&""!=t.color&&(p.css("color",t.color),p.css("border-color",t.color)),isset(t.fontsize)&&""!=t.fontsize&&(p.css("font-size",t.fontsize+"px"),e.fontsize=t.fontsize)}catch(e){console.log(e)}d.setLabel(p[0].outerHTML)}}}},{key:"printTopology",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!App.topControl){var n;console.log("Starting Print Topology"),window.topoChange=!1;var a=new Promise((function(e){n=e}));t&&App.loading(!0),this.labview.empty(),this.labview.selectable(),this.labview.selectable("destroy"),this.labview.selectable({filter:".customShape, .network, .node",start:function(){},stop:function(e,t){"function"==typeof updateFreeSelect&&updateFreeSelect(e,t)},distance:1}),this.labview.removeClass("freeSelectMode"),window.lab_topology=void 0;var o=[];for(var i in this.networks){var l,s=this.networks[i];0!=s.get("visibility")&&(l="bridge"==s.get("type")||"ovs"==s.get("type")?"lan.png":"cloud.png",l=s.get("icon",l),s.component=$('\n                    <div id="network'.concat(i,'" \n                        class="context-menu  network network').concat(i,' network_frame " \n                        style="top: ').concat(s.get("top"),"px; left:").concat(s.get("left"),'px" \n                        data-path="').concat(i,'" \n                        data-name="').concat(s.get("name"),'">\n                        <div class="network_name">').concat(s.get("name"),'</div>\n                        <div class="tag hidden" title="').concat(lang("Connect to another node"),'">\n                            <i class="fa fa-plug plug-icon dropdown-toggle ep"></i>\n                        </div>\n                        <div class=\'quickset tag hidden box_flex\'>\n                            <i data-path="').concat(i,'" title="').concat(lang("Delete"),"\" class='action-networkdelete button node_stop fa fa-trash '></i>\n                            <i data-path=\"").concat(i,'" title="').concat(lang("Edit"),"\" class='action-networkedit control button node_edit fa fa fa-pencil-square'></i>\n                        </div>\n                    </div>\n                ")),this.labview.append(s.component),o.push(new Promise((function(e){var t=new Image;t.onload=e,t.onerror=e,t.onabort=e,t.src="/images/icons/".concat(l),""!=s.get("size")&&(t.style.width="".concat(s.get("size"),"px")),$(t).prependTo(s.component)}))))}var r=function(t){u=e.nodes[t],d='<i title="'.concat(lang(""==u.get("console")?"telnet":u.get("console")),": ").concat(u.get("port"),'" onmousedown="nodehtmlconsoledown()" class=\'node_icon nodehtmlconsole\' nid="').concat(t,'"></i>'),p=""!=u.get("url_2nd")?'<i title="'.concat(lang(""==u.get("console_2nd")?"telnet":u.get("console_2nd")),": ").concat(1e4+Number(u.get("port")),'" onmousedown="nodehtmlconsoledown()" class=\'nodehtmlconsole2nd button fa fa-terminal\' nid="').concat(t,'"></i>'):"",u.component=$('\n                    <div id="node'.concat(t,'" \n                        class="context-menu node node').concat(t,' node_frame "\n                        style="top: ').concat(u.get("top"),"px; left: ").concat(u.get("left"),'px" \n                        data-path="').concat(t,'" \n                        data-status="').concat(u.get("status"),'" \n                        data-name="').concat(u.get("name"),'">\n                        <div class="tag hidden" title="').concat(lang("Connect to another node"),'">\n                            <i class="fa fa-plug plug-icon dropdown-toggle ep"></i>\n                        </div>\n                        <div class=\'quickset tag hidden box_flex\'>\n                            <i data-path="').concat(t,'" title="').concat(lang("Start"),"\" class='action-nodestart button node_start fa fa-play'></i>\n                            <i data-path=\"").concat(t,'" title="').concat(lang("Stop"),"\" class='action-nodestop button node_stop fa fa-stop '></i>\n                            <i data-path=\"").concat(t,'" title="').concat(lang("Edit"),"\" class='action-nodeedit control button node_edit fa fa fa-pencil-square'></i>\n                            <i data-path=\"").concat(t,'" title="').concat(lang("Wipe"),"\" class='action-nodewipe button node_wipe fa fa fa-eraser'></i>\n                            ").concat(p,"\n                        </div>\n                        ").concat(d,'\n                        <div class="node_name"><i class="node_status fa"></i>&nbsp;').concat(u.get("name"),"</div>\n                    </div>")),e.labview.append(u.component),o.push(new Promise((function(e){var n=new Image;n.onload=e,n.onerror=e,n.onabort=e,n.src="/images/icons/".concat(u.get("icon","Router.png")),""!=u.get("size")&&(n.style.width="".concat(u.get("size"),"px")),0==u.get("status")&&(n.className="node_image"),$(n).appendTo("#node".concat(t," .node_icon"))})))};for(var c in this.nodes){var u,d,p;r(c)}for(var h in this.textobjects){var f=this.textobjects[h],m=atob(f.data);try{m=decodeURIComponent(m)}catch(e){}var b=$(m);"text"==f.get("type")?(b.attr("id","customText"+f.get("id")),b.attr("data-path",f.get("id")),this.labview.prepend(b)):this.labview.prepend(b),b.removeClass("ui-selected"),b.removeClass("move-selected"),b.removeClass("dragstopped")}return Promise.all(o).then((function(){jsPlumb.ready((function(){try{window.lab_topology.reset()}catch(e){window.lab_topology=jsPlumb.getInstance()}for(var t in window.moveCount=0,lab_topology.setContainer(e.labview),lab_topology.importDefaults({Anchor:"Continuous",Connector:["Straight"],Endpoint:"Blank",PaintStyle:{strokeWidth:2,stroke:"#c00001"},cssClass:"link"}),e.nodes)e.nodes[t],lab_topology.makeSource("node"+t,{filter:".ep",Anchor:"Continuous",extract:{action:"the-action"},maxConnections:50,onMaxConnections:function(e,t){alert("Maximum connections ("+e.maxConnections+") reached")}}),lab_topology.makeTarget($("#node"+t),{dropOptions:{hoverClass:"dragHover"},anchor:"Continuous",allowLoopback:!1}),"function"==typeof adjustZoom&&adjustZoom(lab_topology,window.scroll_top||0,window.scroll_left||0);for(var a in e.networks)1==e.networks[a].get("visibility")&&(lab_topology.makeSource("network"+a,{filter:".ep",Anchor:"Continuous",extract:{action:"the-action"},maxConnections:50,onMaxConnections:function(e,t){alert("Maximum connections ("+e.maxConnections+") reached")}}),lab_topology.makeTarget($("#network"+a),{dropOptions:{hoverClass:"dragHover"},anchor:"Continuous",allowLoopback:!1})),"function"==typeof adjustZoom&&adjustZoom(lab_topology,window.scroll_top||0,window.scroll_left||0);for(var o in e.links){var i=e.links[o],l=i.source.type,s=["Label"],r=["Label"],c=i.source.node.component.attr("id"),u=i.source.interface.get("name"),d=i.dest.node.component.attr("id"),p="";if(i.dest.interface&&(p=i.dest.interface.get("name")),"ethernet"==l){var h="";null!=i.source.interface&&(h=" "+i.source.interface.get("quality_class"));var f="";null!=i.dest.interface&&(f=" "+i.dest.interface.get("quality_class"));var m="";"1"==i.source.interface.get("suspend")&&(m=" suspended");var b,g="";"1"==i.dest.interface.get("suspend")&&(g=" suspended"),""!=u?s.push({label:"src:"+u,location:.15,cssClass:c+" "+d+h+m}):s.push(Object()),""!=p?r.push({label:"dst:"+p,location:.85,cssClass:c+" "+d+f+g}):r.push(Object()),(b=lab_topology.connect({source:c,target:d,cssClass:c+" "+d+" frame_ethernet",paintStyle:{strokeWidth:2,stroke:"#0066aa"},overlays:[s,r]})).id=o}"serial"==l&&(s.push({label:"src:"+u,location:.15,cssClass:c+" "+d}),r.push({label:"dst:"+p,location:.85,cssClass:c+" "+d}),(b=lab_topology.connect({source:c,target:d,cssClass:c+" "+d+" frame_serial",paintStyle:{strokeWidth:2,stroke:"#ffcc00"},overlays:[s,r]})).id=o),e.applyLinkStyle(b,i.source.interface.get("style",{}))}for(var y in e.lines){var v=e.lines[y];App.lineControl&&App.lineControl.drawline(v.get("params",{}))}0!=LOCK||e.preview||(lab_topology.draggable($(".node_frame, .network_frame, .customShape"),{filter:".ep",containment:!1,grid:[3,3],start:ObjectStartDrag,stop:ObjectPosUpdate}),"function"==typeof adjustZoom&&adjustZoom(lab_topology,window.scroll_top||0,window.scroll_left||0)),"function"==typeof printLabStatus&&printLabStatus(),e.preview||(lab_topology.unbind("connection"),lab_topology.bind("connection",(function(e,t){newConnModal(e,t)})),lab_topology.unbind("contextmenu"),lab_topology.bind("contextmenu",(function(e){connContextMenu(e)}))),1==LOCK&&$(".action-labobjectadd-li").hide(),App.loading(!1),n()}))})),a}showLog(lang("Apply your change first"),"error")}},{key:"createContextMenu",value:function(e){var t=$(e.currentTarget);console.log("contextmenu"),e.stopPropagation(),e.preventDefault();var n="";if(!this.labview.data("prevent-contextmenu")){var a=this.labview.hasClass("freeSelectMode");if(console.log("context menu called"),this.labview.data("contextMenuClickXY",{x:e.pageX,y:e.pageY}),t.hasClass("node_frame")){console.log("DEBUG: opening node context menu");var o=t.attr("data-path"),i=this.nodes[o];if(!i)return void console.log("DEBUG: Can not find node "+o);var l=t.attr("data-status")>1,s=t.attr("data-name")+" ("+o+")",r="",c="";window.nodes[o]&&(r=window.nodes[o].size,c=window.nodes[o].type);var u=i.get("ethernets",{}),d="",p=[];for(var h in u)p.push(u[h]);if(p.sort((function(e,t){var n,a,o,i,l,s=0,r=/(\d+)|(\D+)/g,c=/\d/;if(isFinite(e.get("name"))&&isFinite(t.get("name")))return e-t;if((n=String(e.get("name")).toLowerCase())===(a=String(t.get("name")).toLowerCase()))return 0;if(!c.test(n)||!c.test(a))return n>a?1:-1;for(n=n.match(r),a=a.match(r),l=n.length>a.length?a.length:n.length;s<l;)if((o=n[s])!==(i=a[s++]))return isFinite(o)&&isFinite(i)?("0"===o.charAt(0)&&(o="."+o),"0"===i.charAt(0)&&(i="."+i),o-i):o>i?1:-1;return n.length-a.length})),$.each(p,(function(e,t){"1"==server.user.html5||"1"==server.common.ctrl_docker_wireshark?d+='<li><a class="action-nodecapture context-collapsible menu-interface" href="#" onclick="wireshark_capture('.concat(o,", ").concat(t.get("id"),')" style="display: none;"><i class="glyphicon glyphicon-search"></i> ').concat(t.get("name"),"</a></li>"):d+='<li><a class="action-nodecapture context-collapsible menu-interface" href="capture://'+window.location.hostname+"/vunl"+i.session+"_"+t.get("id")+'" style="display: none;"><i class="glyphicon glyphicon-search"></i> '+t.get("name")+"</a></li>"})),n='<li>\n                        <a class="action-nodestart menu-manage" data-path="'.concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                            <i class="glyphicon glyphicon-play"></i> ').concat(lang("Start"),'\n                        </a>\n                    </li>\n                    <li>\n                        <a class="action-nodestop  menu-manage" data-path="').concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                            <i class="glyphicon glyphicon-stop"></i> ').concat(lang("Stop"),'\n                        </a>\n                    </li>\n                    <li>\n                        <a class="action-nodewipe menu-manage" data-path="').concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                            <i class="glyphicon glyphicon-erase"></i> ').concat(lang("Wipe"),'\n                        </a>\n                    </li>\n                    <li>\n                        <a class="action-nodeunlock menu-manage" data-path="').concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                            <i class="fa fa-unlock-alt"></i> ').concat(lang("Unlock"),"\n                        </a>\n                    </li>\n                \n                    "),""!=i.get("url_2nd")&&(n+='\n                            <li>\n                                <a href="javascript:void(0)" class="menu-manage nodehtmlconsole2nd button" title="'.concat(lang("Secondary Console"),": ").concat(1e4+Number(i.get("port")),'" onmousedown="nodehtmlconsoledown()" nid="').concat(o,'">\n                                    <i class="fa fa-terminal"></i> ').concat(lang("Secondary Console"),"\n                                </a>\n                            </li>\n                            ")),0==LOCK&&(n+='<li>\n                            <a class="action-nodeexport" data-path="'.concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-save"></i> ').concat(lang("Export CFG"),"\n                            </a>\n                        </li>"),n+='<li>\n                            <a class="context-collapsible box_flex" href="javascript:void(0)">\n                                <span class="fa fa-expand" title="'.concat(lang("Node Size"),'"></span>&nbsp;\n                                <input placeholder="').concat(lang("Node Size"),'" min="15" step=1 value="').concat(r,'" data-path="').concat(o,'" style="padding: 0px 5px; width: 100px; border-radius: 2px; border: solid thin;" class="action-nodesize" type="number"></input>\n                                &nbsp;<span>(px)</span>\n                            </a>\n                        </li>'),isAdmin()&&(n+='<li>\n                                <a class="action-nodefolder" data-path="'.concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                    <i class="fa fa-folder-open"></i> ').concat(lang("Node Folder"),"\n                                </a>\n                            </li>"),"docker"!=c&&"qemu"!=c||(n+='<li>\n                                    <a class="action-nodecommit" data-path="'.concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                        <i class="fa fa-thumb-tack"></i> ').concat(lang("Node Commit"),"\n                                    </a>\n                                </li>")))),n+='<li role="separator" class="divider"></li>',n+='<li id="menu-node-interfaces">\n                        <a class="menu-appear" data-path="menu-interface" href="javascript:void(0)">\n                            <i class="glyphicon glyphicon-chevron-right"></i> '.concat(lang("Capture"),'\n                        </a>\n                        <div id="capture-menu">\n                            <ul>').concat(d,"</ul>\n                        </div>\n                    </li>"),0==LOCK&&(n+='<li role="separator" class="divider"><li>',n+='<li>\n                            <a class="action-nodeedit control" data-path="'.concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-edit"></i> ').concat(lang("Edit")," \n                            </a>\n                        </li>"),l||(n+='<li>\n                                <a class="action-nodedelete" data-path="'.concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                    <i class="glyphicon glyphicon-trash"></i> ').concat(lang("Delete"),"\n                                </a>\n                            </li>"))),a){window.contextclick=1;var f=window.freeSelectedNodes[0],m=(r="",""),b="",g=!1,y=!1;if(f&&App.topology.nodes[f.path]){var v=App.topology.nodes[f.path];r=v.get("size");var _=Object.values(v.getInterfaces());for(var E in _){var w=_[E].get("style",{});""==m&&(m=w.fontsize),""==b&&(b=w.width);var S=w.srcpos,k=w.labelpos;try{S=JSON.parse(S)}catch(e){S=null}try{k=JSON.parse(k)}catch(e){k=null}S||(S={}),k||(k={}),g||(g="1"==k.hide),y||(y="1"==S.hide)}}n='<li>\n                            <a class="action-nodestart-group context-collapsible menu-manage" href="javascript:void(0)"><i class="glyphicon glyphicon-play"></i>  '.concat(lang("Start Selected"),'</a>\n                        </li>\n                        <li>\n                            <a class="action-nodestop-group context-collapsible menu-manage" href="javascript:void(0)"><i class="glyphicon glyphicon-stop"></i>  ').concat(lang("Stop Selected"),'</a>\n                        </li>\n                        <li>\n                            <a class="action-nodewipe-group context-collapsible menu-manage" href="javascript:void(0)"><i class="glyphicon glyphicon-erase"></i>  ').concat(lang("Wipe Selected"),'</a>\n                        </li>\n                        <li>\n                            <a class="action-openconsole-group context-collapsible menu-manage" href="javascript:void(0)"><i class="glyphicon glyphicon-console"></i>  ').concat(lang("Console To Selected Nodes"),"</a>\n                        </li>"),0==LOCK&&(n+='<li role="separator" class="divider"></li>\n                            <li>\n                                <a class="action-nodeexport-group context-collapsible menu-manage" href="javascript:void(0)"><i class="glyphicon glyphicon-save"></i> '.concat(lang("Export all CFGs"),'</a>\n                            </li>\n                            <li>\n                                <a class="action-nodesbootsaved-group" href="javascript:void(0)"><i class="glyphicon glyphicon-floppy-saved"></i> ').concat(lang("Set nodes startup-cfg to exported"),'</a>\n                            </li>\n                            <li>\n                                <a class="action-nodesbootscratch-group" href="javascript:void(0)"><i class="glyphicon glyphicon-floppy-save"></i> ').concat(lang("Set nodes startup-cfg to none"),"</a>\n                            </li>"),n+='<li>\n                                <a class="context-collapsible" href="javascript:void(0)">\n                                    <span class="fa fa-expand" title="Node Size"></span>&nbsp;\n                                    <input placeholder="'.concat(lang("Node Size"),'" value="').concat(r,'" step=1 min=15 style="padding: 0px 5px; width: 100px; border-radius: 2px; border: solid thin;" class="action-nodesize" type="number"></input>\n                                    &nbsp;<span>Node Size (px)</span>\n                                </a>\n                            </li>\n                            \n                            <li>\n                                <a class="context-collapsible" href="javascript:void(0)">\n                                    <span class="fa fa-arrows-h" title="Link Width"></span>&nbsp;\n                                    <input placeholder="').concat(lang("Link Width"),'" value="').concat(b,'" step=1 min=0 style="padding: 0px 5px; width: 100px; border-radius: 2px; border: solid thin;" class="action-linkwidth" type="number"></input>\n                                    &nbsp;<span>Link Width (px)</span>\n                                </a>\n                            </li>\n\n\n                            <li>\n                                <a class="context-collapsible" href="javascript:void(0)">\n                                    <span class="fa fa-text-height" title="Label Size"></span>&nbsp;\n                                    <input placeholder="').concat(lang("Label Size"),'" value="').concat(m,'" step=1 min=5 style="padding: 0px 5px; width: 100px; border-radius: 2px; border: solid thin;" class="action-labelsize" type="number"></input>\n                                    &nbsp;<span>Label Size (px)</span>\n                                </a>\n                            </li>\n\n                            <li>\n                                <a class="context-collapsible box_flex" href="javascript:void(0)" style="display:flex">\n                                    <span class="fa fa-low-vision" title="Hide Labels"></span>&nbsp; <span>Hide Labels : </span>\n                                    <input placeholder="').concat(lang("Hide Labels"),'" ').concat(g?"checked":"",'  style="padding: 0px 5px; margin: auto 5px auto auto; border-radius: 2px; border: solid thin;" class="action-hidelabel" type="checkbox"></input>\n                                </a>\n                            </li>\n\n                            <li>\n                                <a class="context-collapsible box_flex" href="javascript:void(0)" style="display:flex">\n                                    <span class="fa fa-low-vision" title="Hide Port Labels"></span>&nbsp; <span>Hide Port Labels : </span>\n                                    <input placeholder="').concat(lang("Hide Port Labels"),'" ').concat(y?"checked":"",'  style="padding: 0px 5px; margin: auto 5px auto auto; border-radius: 2px; border: solid thin;" class="action-hideportlabel" type="checkbox"></input>\n                                </a>\n                            </li>\n                            \n                            \n                            '),n+='<li role="separator" class="divider">\n                        <li>\n                            <a class="action-halign-group" data-path="node'.concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-object-align-horizontal"></i> ').concat(lang("Horizontal Align"),'\n                            </a>\n                        </li>\n                        <li>\n                            <a class="action-valign-group" data-path="node').concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-object-align-vertical"></i> ').concat(lang("Vertical Align"),'\n                            </a>\n                        </li>\n                        <li>\n                            <a class="action-calign-group" data-path="node').concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-record"></i> ').concat(lang("Circular Align"),'\n                            </a>\n                        </li>\n                        <li>\n                            <a class="action-autoalign-group" data-path="node').concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-th"></i> ').concat(lang("Auto Align"),"\n                            </a>\n                        </li>\n                        "),n+='<li role="separator" class="divider"></li>\n                        <li>\n                            <a class="action-nodesbootdelete-group" href="javascript:void(0)"><i class="glyphicon glyphicon-trash"></i> '.concat(lang("Delete nodes startup-cfg"),'</a>\n                        </li>\n                        <li>\n                            <a class="action-nodedelete-group context-collapsible menu-manage" href="javascript:void(0)"><i class="glyphicon glyphicon-trash"></i> ').concat(lang("Delete Selected"),"</a>\n                        </li>")),s="Group of "+window.freeSelectedNodes.map((function(e){if("node"==e.type)return e.name})).join(", ").replace(", ,",", ").replace(/^,/,"").slice(0,16),s+=s.length>24?"...":""}}if(t.hasClass("network_frame")&&0==LOCK){if(!a){console.log("DEBUG: opening network context menu");var x=t.attr("data-path");s=t.attr("data-name"),n='<li>\n                            <a class="context-collapsible  action-networkedit" data-path="'.concat(x,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-edit"></i> ').concat(lang("Edit"),'\n                            </a>    \n                        </li>\n\n                        <li>\n                            <a class="context-collapsible action-networkdelete" data-path="').concat(x,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-trash"></i> ').concat(lang("Delete"),"\n                            </a>\n                        </li>")}a&&(s=lang("Edit selected Networks"),x=t.attr("data-path"),n+=' <li>\n                                <a class="context-collapsible action-networkdelete" data-path="'.concat(x,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                    <i class="glyphicon glyphicon-trash"></i> ').concat(lang("Delete"),'\n                                </a>\n                            </li>\n                    \n                        <li role="separator" class="divider">\n\n                        <li>\n                            <a class="action-halign-group" data-path="network').concat(x,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-object-align-horizontal"></i> ').concat(lang("Horizontal Align"),'\n                            </a>\n                        </li>\n\n                        <li>\n                            <a class="action-valign-group" data-path="network').concat(x,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-object-align-vertical"></i> ').concat(lang("Vertical Align"),'\n                            </a>\n                        </li>\n\n                        <li>\n                            <a class="action-calign-group" data-path="network').concat(x,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-record"></i> ').concat(lang("Circular Align"),'\n                            </a>\n                        </li>\n                        <li>\n                            <a class="action-autoalign-group" data-path="node').concat(o,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                <i class="glyphicon glyphicon-th"></i> ').concat(lang("Auto Align"),"\n                            </a>\n                        </li>\n                        "))}if((t.hasClass("customText")||t.hasClass("customShape"))&&0==LOCK){if(!a){console.log("DEBUG: opening text object context menu");var N=t.attr("data-path"),L=(s="Edit: "+t.attr("data-path"),t.hasClass("customText")?" customText ":""),O=/rotate\(([\+\-\d]+)deg\).*skew\(([\+\-\d]+)deg\).*/.exec(e.currentTarget.style.transform),C=0,T=0;O&&(C=O[1],T=O[2]),n='<li>\n                                    <a class="context-collapsible  action-textobjectduplicate" href="javascript:void(0)" data-path="'.concat(N,'">\n                                        <i class="glyphicon glyphicon-duplicate"></i> ').concat(lang("Duplicate"),'\n                                    </a>\n                                </li>\n                                <li>\n                                    <a class="context-collapsible  action-textobjecttoback" href="javascript:void(0)" data-path="').concat(N,'">\n                                        <i class="glyphicon glyphicon-save"></i> ').concat(lang("Send To Back"),'\n                                    </a>\n                                </li>\n                                <li>\n                                    <a class="context-collapsible  action-textobjecttofront" href="javascript:void(0)" data-path="').concat(N,'">\n                                        <i class="glyphicon glyphicon-open"></i> ').concat(lang("Send To Front"),'\n                                    </a>\n                                </li>\n\n                                <li>\n                                    <a class="context-collapsible" href="javascript:void(0)" data-path="').concat(N,'">\n                                        <span style="width:20px; display:inline-block" class="glyphicon glyphicon-refresh" title="').concat(lang("Rotate"),'"></span>&nbsp;\n                                        <input placeholder="').concat(lang("Rotate"),'" step=1 value="').concat(C,'" style="padding: 0px 5px; width: 100px; border-radius: 2px; border: solid thin;" class="action-textrotate" data-path="').concat(N,'" type="number"></input>\n                                    </a>\n                                </li>\n\n                                <li>\n                                    <a class="context-collapsible" href="javascript:void(0)" data-path="').concat(N,'">\n                                        <span style="width:20px; display:inline-block"><b title="').concat(lang("3D Rotate"),'">3D</b></span>&nbsp;\n                                        <input placeholder="').concat(lang("3D Rotate"),'" step=1 value="').concat(T,'" style="padding: 0px 5px; width: 100px; border-radius: 2px; border: solid thin;" class="action-textskew" data-path="').concat(N,'" type="number"></input>\n                                    </a>\n                                </li>\n\n                                <li>\n                                    <a class="context-collapsible ').concat(L,' action-textobjectdelete" href="javascript:void(0)" data-path="').concat(N,'">\n                                        <i class="glyphicon glyphicon-trash"></i> ').concat(lang("Delete"),"\n                                    </a>\n                                </li>")}a&&(s=lang("Edit selected Texts"),N=t.attr("data-path"),n='<li>\n                                    <a class="context-collapsible '.concat(L,' action-textobjectdelete" href="javascript:void(0)" data-path="').concat(N,'">\n                                        <i class="glyphicon glyphicon-trash"></i> ').concat(lang("Delete"),'\n                                    </a>\n                                </li>\n                                <li role="separator" class="divider"></li>\n                                <li>\n                                    <a class="action-halign-group" data-path="customText').concat(N,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                        <i class="glyphicon glyphicon-object-align-horizontal"></i> ').concat(lang("Horizontal Align"),'\n                                    </a>\n                                </li>\n                                <li>\n                                    <a class="action-valign-group" data-path="customText').concat(N,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                        <i class="glyphicon glyphicon-object-align-vertical"></i> ').concat(lang("Vertical Align"),'\n                                    </a>\n                                </li>\n                                <li>\n                                    <a class="action-calign-group" data-path="customText').concat(N,'" data-name="').concat(s,'" href="javascript:void(0)">\n                                        <i class="glyphicon glyphicon-record"></i> ').concat(lang("Circular Align"),"\n                                    </a>\n                                </li>"))}n.length&&printContextMenu(s,n,e)}}},{key:"ObjectPosUpdateExec",value:function(e,t){var n=this,a=[];0==t.length?a.push(e.el):t.each((function(e,t){a.push(t)})),console.log("DEBUG: moving objects...0"),window.dragstop=0;var o=getZoomLab()/100;if(a.length>1&&(window.dragstop=1),!(e.metaKey||null!=e.e&&e.e.metaKey||e.ctrlKey||null!=e.e&&e.e.ctrlKey)){console.log("DEBUG: moving objects...1");var i=[],l=[],s=[],r=[];$.each(a,(function(e,t){var n=Math.round($("#"+t.id).position().left/o+$("#lab-viewport").scrollLeft()),a=Math.round($("#"+t.id).position().top/o+$("#lab-viewport").scrollTop());if(e=t.id,$("#"+e).addClass("dragstopped"),-1!=e.search("node"))console.log("DEBUG: setting"+e+" position."),i.push({id:e.replace("node",""),left:n,top:a});else if(-1!=e.search("network"))console.log("DEBUG: setting "+e+" position."),s.push({id:e.replace("network",""),left:n,top:a});else if(-1!=e.search("custom")){console.log("DEBUG: setting "+e+" position.");var c=t.outerHTML;c=fromByteArray(new TextEncoderLite("utf-8").encode(encodeURIComponent(c))),l.push({id:e.replace(/customShape/,"").replace(/customText/,""),data:c})}else-1!=e.search("startLine")?r.push({id:e.replace(/\D/g,""),x1:n,y1:a}):-1!=e.search("endLine")&&r.push({id:e.replace(/\D/g,""),x2:n,y2:a})}));var c={},u={},d={},p={},h={},f={},m={},b={},g=get(this.histories[this.historyIndex],{}),y=get(g.nodes,{}),v=get(g.networks,{}),_=get(g.texts,{}),E=get(g.lines,{}),w=!0;i.map((function(e){var t=e.id;h[t]=e;var a=n.nodes[t];a&&(isset(y[t])||(w=!1),c[t]={id:a.get("id"),left:a.get("left"),top:a.get("top")})})),s.map((function(e){var t=e.id;f[t]=e;var a=n.networks[t];a&&(isset(v[t])||(w=!1),u[t]={id:a.get("id"),left:a.get("left"),top:a.get("top")})})),l.map((function(e){var t=e.id;m[t]=e;var a=n.textobjects[t];a&&(isset(_[t])||(w=!1),d[t]={id:a.get("id"),data:a.get("data")})})),r.map((function(e){var t=e.id;b[t]=e;var a=n.lines[e.id];a&&(isset(E[t])||(w=!1),p[t]={id:a.get("id"),x1:a.get("x1"),x2:a.get("x2"),y1:a.get("y1"),y2:a.get("y2")})})),this.histories.splice(this.historyIndex+1),w||(this.histories.push({nodes:c,networks:u,texts:d,lines:p}),this.histories.length>50&&this.histories.splice(0,1),this.historyIndex=this.histories.length-1);var S=$.Deferred();return $.when(setNodesPosition(i)).done((function(){console.log("DEBUG: all selected node position saved."),$.when(editTextObjects(l)).done((function(){console.log("DEBUG: all selected shape position saved."),$.when(setNetworksPosition(s)).done((function(){console.log("DEBUG: all selected networks position saved."),"function"==typeof setLinePosition&&setLinePosition(r).then((function(){n.histories.push({nodes:h,networks:f,texts:m,lines:b}),n.histories.length>50&&n.histories.splice(0,1),n.historyIndex=n.histories.length-1,console.log(n.histories),S.resolve()}))})).fail((function(e){addModalError(e)}))})).fail((function(e){addModalError(e)}))})).fail((function(e){addModalError(e)})),S}}},{key:"undoPosition",value:function(){var e=this;if(this.historyIndex--,!(this.historyIndex<0)){isset(this.histories[this.historyIndex])||(this.historyIndex=this.histories.length-1);var t=this.histories[this.historyIndex],n=Object.values(get(t.nodes,{})),a=Object.values(get(t.texts,{})),o=Object.values(get(t.networks,{})),i=Object.values(get(t.lines,{}));App.loading(!0);var l=$.Deferred();return $.when(setNodesPosition(n)).done((function(){console.log("DEBUG: all selected node position saved."),$.when(editTextObjects(a)).done((function(){console.log("DEBUG: all selected shape position saved."),$.when(setNetworksPosition(o)).done((function(){console.log("DEBUG: all selected networks position saved."),"function"==typeof setLinePosition&&setLinePosition(i).then((function(){e.printTopology().then((function(){return App.loading(!1)}))}))})).fail((function(e){addModalError(e)}))})).fail((function(e){addModalError(e)}))})).fail((function(e){addModalError(e)})),l}this.historyIndex=0}},{key:"redoPosition",value:function(){var e=this;if(this.historyIndex++,isset(this.histories[this.historyIndex])){var t=this.histories[this.historyIndex],n=Object.values(get(t.nodes,{})),a=Object.values(get(t.texts,{})),o=Object.values(get(t.networks,{})),i=Object.values(get(t.lines,{}));App.loading(!0);var l=$.Deferred();return $.when(setNodesPosition(n)).done((function(){console.log("DEBUG: all selected node position saved."),$.when(editTextObjects(a)).done((function(){console.log("DEBUG: all selected shape position saved."),$.when(setNetworksPosition(o)).done((function(){console.log("DEBUG: all selected networks position saved."),"function"==typeof setLinePosition&&setLinePosition(i).then((function(){e.printTopology().then((function(){return App.loading(!1)}))}))})).fail((function(e){addModalError(e)}))})).fail((function(e){addModalError(e)}))})).fail((function(e){addModalError(e)})),l}this.historyIndex=this.histories.length-1}}])&&r(n.prototype,c),u&&r(n,u),t}();t.a=c}).call(this,n(1))},195:function(e,t,n){"use strict";var a=n(0),o=n.n(a);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return(l="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=r(this,c(t).call(this,e))).selected=[],n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null)}},{key:"setSelected",value:function(){$("#lab-viewport").addClass("freeSelectMode"),window.freeSelectedNodes=this.selected,this.selected.map((function(e){$("#node"+e.path).addClass("ui-selected")}))}},{key:"updateComboLink",value:function(e){var t=this;return App.loading(!0),axios.request({url:"/api/labs/session/interfaces/styles",method:"post",data:{data:e}}).then((function(e){App.loading(!1),"success"==(e=e.data).status?(App.topology.updateData(e.update),App.topology.printTopology().then((function(){t.setSelected()}))):(error_handle(e),App.topology.printTopology())})).catch((function(e){App.loading(!1),error_handle(e),console.log(e),App.topology.printTopology()}))}},{key:"componentDidMount",value:function(){var e=this;$(document).on("change",".action-linkwidth",(function(t){var n=$("#lab-viewport").hasClass("freeSelectMode"),a=[];n&&(e.selected=window.freeSelectedNodes,window.freeSelectedNodes.forEach((function(e){var n=e.path,o=App.topology.nodes[n];if(o){var i=o.getInterfaces();for(var l in i){var s=i[l];if("ethernet"==s.get("type")){var r=s.get("network_id");r>0&&(0==App.topology.networks[r].get("visibility")?a.push({network_id:r,width:t.target.value}):a.push({interface_id:l,node_id:n,width:t.target.value}))}else s.get("remote_id")>0&&a.push({interface_id:l,node_id:n,width:t.target.value})}}}))),a.length>0&&(e.updateTimeout&&clearTimeout(e.updateTimeout),e.updateTimeout=setTimeout((function(){return e.updateComboLink(a)}),500))})),$(document).on("change",".action-labelsize",(function(t){var n=$("#lab-viewport").hasClass("freeSelectMode"),a=[];n&&(e.selected=window.freeSelectedNodes,window.freeSelectedNodes.forEach((function(e){var n=e.path,o=App.topology.nodes[n];if(o){var i=o.getInterfaces();for(var l in i){var s=i[l];if("ethernet"==s.get("type")){var r=s.get("network_id");r>0&&(0==App.topology.networks[r].get("visibility")?a.push({network_id:r,fontsize:t.target.value}):a.push({interface_id:l,node_id:n,fontsize:t.target.value}))}else s.get("remote_id")>0&&a.push({interface_id:l,node_id:n,fontsize:t.target.value})}}})))})),$(document).on("change",".action-labelsize",(function(t){var n=$("#lab-viewport").hasClass("freeSelectMode"),a=[];n&&(e.selected=window.freeSelectedNodes,window.freeSelectedNodes.forEach((function(e){var n=e.path,o=App.topology.nodes[n];if(o){var i=o.getInterfaces();for(var l in i){var s=i[l];if("ethernet"==s.get("type")){var r=s.get("network_id");r>0&&(0==App.topology.networks[r].get("visibility")?a.push({network_id:r,fontsize:t.target.value}):a.push({interface_id:l,node_id:n,fontsize:t.target.value}))}else s.get("remote_id")>0&&a.push({interface_id:l,node_id:n,fontsize:t.target.value})}}}))),a.length>0&&(e.updateTimeout&&clearTimeout(e.updateTimeout),e.updateTimeout=setTimeout((function(){return e.updateComboLink(a)}),500))})),$(document).on("change",".action-hidelabel",(function(t){var n=$("#lab-viewport").hasClass("freeSelectMode"),a=[];n&&(e.selected=window.freeSelectedNodes,window.freeSelectedNodes.forEach((function(e){var n=e.path,o=App.topology.nodes[n];if(o){var i=o.getInterfaces();for(var l in i){var s=i[l],r=s.get("labelpos");try{r=JSON.parse(r)}catch(e){r={}}if(r||(r={}),r.hide=t.target.checked,"ethernet"==s.get("type")){var c=s.get("network_id");c>0&&(0==App.topology.networks[c].get("visibility")?a.push({network_id:c,labelpos:JSON.stringify(r)}):a.push({interface_id:l,node_id:n,labelpos:JSON.stringify(r)}))}else s.get("remote_id")>0&&a.push({interface_id:l,node_id:n,labelpos:JSON.stringify(r)})}}}))),a.length>0&&e.updateComboLink(a)})),$(document).on("change",".action-hideportlabel",(function(t){var n=$("#lab-viewport").hasClass("freeSelectMode"),a=[];n&&(e.selected=window.freeSelectedNodes,window.freeSelectedNodes.forEach((function(e){var n=e.path,o=App.topology.nodes[n];if(o){var i=o.getInterfaces();for(var l in i){var s=i[l],r=s.get("srcpos");try{r=JSON.parse(r)}catch(e){r={}}r||(r={}),r.hide=t.target.checked;var c=s.get("dstpos");try{c=JSON.parse(c)}catch(e){c={}}if(c||(c={}),c.hide=t.target.checked,"ethernet"==s.get("type")){var u=s.get("network_id");u>0&&(0==App.topology.networks[u].get("visibility")?a.push({network_id:u,srcpos:JSON.stringify(r),dstpos:JSON.stringify(c)}):a.push({interface_id:l,node_id:n,srcpos:JSON.stringify(r),dstpos:JSON.stringify(c)}))}else s.get("remote_id")>0&&a.push({interface_id:l,node_id:n,srcpos:JSON.stringify(r),dstpos:JSON.stringify(c)})}}}))),a.length>0&&e.updateComboLink(a)}))}}])&&s(n.prototype,a),i&&s(n,i),t}(a.Component);t.a=d},196:function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.centerPoint={x:0,y:0},this.object=null,this.transform={x:0,y:0},this.moving=this.moving.bind(this),this.stop=this.stop.bind(this),this.onStop=t}var t,n,o;return t=e,(n=[{key:"setObject",value:function(e){if(this.object=e,null!=this.object){var t=this.object.style.transform,n=/.*translate\(([\d\+\-]+)px, ([\d\+\-]+)px\).*/.exec(t);this.transform=n?{x:Number(n[1]),y:Number(n[2])}:{x:0,y:0};var a=this.getPos(e.offsetParent);this.centerPoint={x:a.x,y:a.y},document.addEventListener("mousemove",this.moving),document.addEventListener("mouseup",this.stop)}}},{key:"moving",value:function(e){if(null!=this.object){var t=1;"function"==typeof getZoomLab&&(t=getZoomLab()/100);var n=e.clientX/t,a=e.clientY/t,o={x:n-this.centerPoint.x,y:a-this.centerPoint.y};this.object.style.transform="translate(".concat(o.x,"px, ").concat(o.y,"px)"),this.transform=o}}},{key:"stop",value:function(e){document.removeEventListener("mousemove",this.moving),document.removeEventListener("mouseup",this.stop),this.onStop&&this.onStop(this.object,this.transform),this.object=null}},{key:"getPos",value:function(e){for(var t=0,n=0;null!=e;t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent);return{x:t,y:n}}}])&&a(t.prototype,n),o&&a(t,o),e}();t.a=o},213:function(e,t,n){"use strict";var a=n(0),o=n.n(a),i=(n(6),n(521)),l=n(522),s=n(95),r=n(91),c=n(92),u=n(209),d=(n(597),n(523)),p=(n(598),n(524)),h=n(93),f=n(94);n(599),n(212),n(602);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e){return(b="function"==typeof Symbol&&"symbol"===m(Symbol.iterator)?function(e){return m(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":m(e)})(e)}function g(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=function(e){function t(e){var n,a,i,l,s,r,c,d,p,h,f;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(f=_(this,E(t).call(this,e))).id=makeId(),f.users_struct={},f.users_struct[STRUCT_FILTERS]={},f.users_struct[STRUCT_COLUMNS]=(y(s={},USER_USERNAME,(y(n={},COL_NAME,lang(USER_USERNAME)),y(n,COL_SORT,!1),y(n,COL_DECORATOR_IN,(function(e,t,n){var a=n[t];return 1==a[USER_OFFLINE]?o.a.createElement("span",{title:"Offline Account"},o.a.createElement("i",{className:"fa fa-map-marker",style:{color:"red",fontSize:16}})," ",formatName(a[USER_USERNAME])):o.a.createElement("span",{title:"Online Account"},o.a.createElement("i",{className:"fa fa-globe",style:{color:"#4caf50"}})," ",formatName(a[USER_USERNAME]))})),y(n,COL_STYLE,{whiteSpace:"nowrap"}),n)),y(s,USER_EMAIL,(y(a={},COL_NAME,lang(USER_EMAIL)),y(a,COL_SORT,!0),a)),y(s,USER_ROLE,(y(i={},COL_NAME,lang(USER_ROLE)),y(i,COL_SORT,!1),i)),y(s,USER_NOTE,(y(l={},COL_NAME,lang(USER_NOTE)),y(l,COL_SORT,!1),y(l,COL_DECORATOR_IN,(function(e){return HtmlDecode(e)})),l)),s),f.users_struct[STRUCT_FILTERS]=(y(p={},USER_EMAIL,(y(r={},FILTER_NAME,lang(USER_EMAIL)),y(r,FILTER_TYPE,"text"),r)),y(p,USER_ROLE,(y(c={},FILTER_NAME,lang(USER_ROLE)),y(c,FILTER_TYPE,"select"),c)),y(p,USER_NOTE,(y(d={},FILTER_NAME,lang(USER_NOTE)),y(d,FILTER_TYPE,"text"),d)),p),f.users_struct[STRUCT_EDIT]={},f.users_struct[STRUCT_ROWS]=y({},ROW_FUNCS,(function(e){return[o.a.createElement(u.a,{key:1,rowData:e})]})),f.users_struct[STRUCT_TABLE]=(y(h={},DATA_TABLE_ID,USERS_TABLE),y(h,DATA_FILTERS,{}),y(h,DATA_HIDDEN_COL,{}),y(h,DATA_PERMIT_COL,f.permissionUsers()),y(h,DATA_SORT,y({},USER_ONLINE_TIME,"desc")),y(h,DATA_KEY,[USER_POD]),y(h,FLAG_FILTER_CHANGE,!0),y(h,FLAG_MULTI_SORT,!1),y(h,FLAG_RESIZABLE,!0),y(h,FLAG_SELECT_ROWS,!0),y(h,FLAG_SETTING_ROWS,!1),y(h,FLAG_EXPAND_ROWS,!1),y(h,FLAG_HEAD_ROW,!0),y(h,LINK_FILTER,"/store/public/admin/users/filter"),y(h,LINK_MAPPING,"/store/public/admin/users/mapping"),h),f}var n,a,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,e),n=t,(a=[{key:"permissionUsers",value:function(){return Object.assign.apply(Object,g(Object.keys(this.users_struct[STRUCT_COLUMNS]).map((function(e,t){return y({},e,"Read")}))).concat(g(Object.keys(this.users_struct[STRUCT_EDIT]).map((function(e,t){return y({},e,"Write")})))))}},{key:"modal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"show";"hide"==e?$("#"+this.id).modal("hide"):$("#"+this.id).modal()}},{key:"setOnSelect",value:function(e){this.onSelect=e}},{key:"setSelect",value:function(e){var t={};for(var n in e)if(!isNaN(Number(e[n]))){var a=this.table.createKey(y({},USER_POD,e[n])),o=a.key,i=a.value;t[o]=i}console.log(t),dispatchEvent,this.table[STRUCT_TABLE][DATA_SELECT_ROWS]=t,this.table.reload()}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"modal fade",id:this.id,style:{background:"#00000080"}},o.a.createElement("div",{className:"modal-dialog modal-lg",role:"document",style:{maxWidth:"80%"}},o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"modal-header"},o.a.createElement("h4",{className:"modal-title"},lang("Users")),o.a.createElement("i",{type:"button",className:"close",onClick:function(){e.modal("hide")}},"×")),o.a.createElement("div",{className:"modal-body"},o.a.createElement(i.a,{ref:function(t){return e.table=t},table:this.users_struct,autoload:!0},o.a.createElement(l.a,null),o.a.createElement(c.a,{left:o.a.createElement(d.a,null),right:o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"button box_flex",onClick:function(){e.table[STRUCT_TABLE][DATA_SELECT_ROWS]={},e.table.reload()}},o.a.createElement("i",{className:"fa fa-eraser"})," ",lang("Empty Selection")),o.a.createElement(p.a,null),o.a.createElement(h.a,null),o.a.createElement(f.a,null))}),o.a.createElement(s.a,{className:"table table-bordered table-resizable"}),o.a.createElement(r.a,null))),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){e.modal("hide")}},lang("Cancel")),o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){e.onSelectHandle()}},lang("Select"))))))}},{key:"onSelectHandle",value:function(){var e=this.table[STRUCT_TABLE][DATA_SELECT_ROWS],t=[];for(var n in e)t.push(e[n][USER_POD]);this.onSelect&&this.onSelect(t),this.modal("hide")}}])&&v(n.prototype,a),m&&v(n,m),t}(a.Component);t.a=S},33:function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(){function e(t,n){for(var a in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t)this[a]=t[a];this.type=n,this.quality_class="",isset(this.quality)&&-1!==Object.values(this.quality).findIndex((function(e){return""!=e}))&&(this.quality_class="quality_applied")}var t,n,o;return t=e,(n=[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return void 0!==this[e]?this[e]:t}}])&&a(t.prototype,n),o&&a(t,o),e}();t.a=o},525:function(e,t,n){"use strict";var a=n(0),o=n.n(a);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return(l="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(e){var n,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(o=r(t).call(this,e))||"object"!==l(o)&&"function"!=typeof o?c(a):o).getSession=n.getSession.bind(c(n)),n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null)}},{key:"componentDidMount",value:function(){this.getSession(),this.intervalId=setInterval(this.getSession,17e3)}},{key:"componentWillUnmount",value:function(){this.intervalId&&clearInterval(this.intervalId)}},{key:"getSession",value:function(){var e=this;axios.request({url:"/store/public/admin/lab_sessions/getSession",method:"post"}).then((function(t){(t=t.data).result?e.props.callback&&e.props.callback(t.data):error_handle(t)})).catch((function(e){console.log(e),error_handle(e)}))}}])&&s(n.prototype,a),i&&s(n,i),t}(a.Component);t.a=d},530:function(e,t,n){"use strict";(function(e){var a=n(0),o=n.n(a),i=n(6),l=n(13),s=n(213);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){return(c="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)})(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function p(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(t){function n(e){var t,a,o,i,l,s,r,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(c=p(this,h(n).call(this,e))).id=makeId(),c.state={joinable:0,joinable_emails:[],openable:0,openable_emails:[],editable:0,editable_emails:[],users:{}},c.struct={author:(t={},u(t,INPUT_TYPE,"text"),u(t,INPUT_NULL,!0),t),description:(a={},u(a,INPUT_TYPE,"textarea"),u(a,INPUT_NULL,!0),a),filename:(o={},u(o,INPUT_TYPE,"text"),u(o,INPUT_WRITABLE,!1),o),scripttimeout:(i={},u(i,INPUT_TYPE,"number"),u(i,INPUT_NULL,!0),u(i,INPUT_DEFAULT,300),i),version:(l={},u(l,INPUT_TYPE,"text"),u(l,INPUT_DEFAULT,1),l),name:(s={},u(s,INPUT_TYPE,"text"),u(s,INPUT_NULL,!1),s),countdown:(r={},u(r,INPUT_TYPE,"number"),u(r,INPUT_NULL,!0),u(r,INPUT_DEFAULT,60),r)},c.path="/",c}var a,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),a=n,(r=[{key:"modal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"show";"hide"==e?$("#"+this.id).modal("hide"):$("#"+this.id).modal()}},{key:"componentDidMount",value:function(){var t=this;$("#".concat(this.id)).on("hidden.bs.modal",(function(e){e.preventDefault(),e.stopPropagation()})),e.editLab=function(e){t.modal(),t.path=e,t.loadLab(),t.getMapUser()}}},{key:"getMapUser",value:function(){var e=this;return axios.request({url:"/store/public/admin/lab_sessions/mapUser",method:"post"}).then((function(t){if(!(t=t.data).result)return error_handle(t),!1;e.setState({users:t.data})})).catch((function(e){console.log(e),error_handle(e)}))}},{key:"showUsers",value:function(e){var t=this,n=[];return e.map((function(e){if(isset(t.state.users[e])){var a="(online)";1==t.state.users[e][USER_OFFLINE]&&(a=""),n.push(formatName(t.state.users[e][USER_USERNAME])+a)}else n.push(e)})),n.join(", ")}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"modal fade",id:this.id},o.a.createElement("div",{className:"modal-dialog modal-lg",role:"document",style:{maxWidth:"90%"}},o.a.createElement("div",{className:"modal-content",style:{position:"absolute"}},o.a.createElement(l.a,{ref:function(t){return e.loading=t},style:{position:"absolute"}}),o.a.createElement("div",{className:"modal-header"},o.a.createElement("h4",{className:"modal-title"},"Edit Lab"),o.a.createElement("i",{type:"button",className:"close","data-dismiss":"modal","aria-hidden":"true"},"×")),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-12",style:{fontWeight:"bold"}},"Lab File: ",o.a.createElement("i",{style:{color:"rgb(23, 162, 184)"}},this.path))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},o.a.createElement("div",null),o.a.createElement("div",{className:"box_flex lab_item"},o.a.createElement("div",{className:"col-md-4 box_line input_item_text"},lang("Version")),o.a.createElement("div",{className:"col-md-8"},o.a.createElement(i.a,{className:"input_item_input",ref:function(t){return e.versionInput=t},struct:this.struct.version}))),o.a.createElement("div",{className:"box_flex lab_item"},o.a.createElement("div",{className:"col-md-4 box_line input_item_text"},lang("Author")),o.a.createElement("div",{className:"col-md-8"},o.a.createElement(i.a,{className:"input_item_input",ref:function(t){return e.authorInput=t},struct:this.struct.author}))),o.a.createElement("div",{className:"box_flex lab_item"},o.a.createElement("div",{className:"col-md-4 box_line input_item_text"},lang("Config Script Timeout")),o.a.createElement("div",{className:"col-md-4"},o.a.createElement(i.a,{className:"input_item_input",type:"number",ref:function(t){return e.scripttimeoutInput=t},struct:this.struct.scripttimeout})),o.a.createElement("div",{className:"col-md-4"},lang("Seconds"))),o.a.createElement("div",{className:"box_flex lab_item"},o.a.createElement("div",{className:"col-md-4 box_line input_item_text"},lang("Countdonw Timer")),o.a.createElement("div",{className:"col-md-4"},o.a.createElement(i.a,{className:"input_item_input",type:"number",ref:function(t){return e.countdownInput=t},struct:this.struct.countdown})),o.a.createElement("div",{className:"col-md-4"},lang("Minutes"))),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement("div",{className:"col-12"},o.a.createElement("div",{className:"input_item_text"},lang("Description")),o.a.createElement("div",null,o.a.createElement(i.a,{className:"input_item_input",ref:function(t){return e.descriptionInput=t},struct:this.struct.description}))))),o.a.createElement("div",{className:"col-md-6"},o.a.createElement("div",null,o.a.createElement("div",{className:"input_item_text"},lang("who_open_lab")),o.a.createElement("div",{className:"button input_item_option",select:0==this.state.openable?"true":"false",onClick:function(){return e.setState({openable:0})}},o.a.createElement("i",{className:"fa icon"}),"  ",lang("Admin Only")),o.a.createElement("div",{className:"button input_item_option",select:1==this.state.openable?"true":"false",onClick:function(){return e.setState({openable:1})}},o.a.createElement("i",{className:"fa icon"}),"  ",lang("Everyone")),o.a.createElement("div",{className:"button input_item_option",select:2==this.state.openable?"true":"false",onClick:function(){return e.setState({openable:2})}},o.a.createElement("i",{className:"fa icon"}),"  ",lang("Admin and Special users")),o.a.createElement("textarea",{disabled:2!=this.state.openable,readOnly:!0,className:"input_item_input",value:this.showUsers(this.state.openable_emails),onClick:function(){e.userModal.modal(),e.userModal.setSelect(e.state.openable_emails),e.userModal.setOnSelect((function(t){return e.setState({openable_emails:t})}))}})),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement("div",{className:"input_item_text"},lang("who_join_lab")),o.a.createElement("div",{className:"button input_item_option",select:0==this.state.joinable?"true":"false",onClick:function(){return e.setState({joinable:0})}},o.a.createElement("i",{className:"fa icon"}),"  ",lang("Admin Only")),o.a.createElement("div",{className:"button input_item_option",select:1==this.state.joinable?"true":"false",onClick:function(){return e.setState({joinable:1})}},o.a.createElement("i",{className:"fa icon"}),"  ",lang("Everyone")),o.a.createElement("div",{className:"button input_item_option",select:2==this.state.joinable?"true":"false",onClick:function(){return e.setState({joinable:2})}},o.a.createElement("i",{className:"fa icon"}),"  ",lang("Admin and Special users")),o.a.createElement("textarea",{disabled:2!=this.state.joinable,readOnly:!0,className:"input_item_input",value:this.showUsers(this.state.joinable_emails),onClick:function(){e.userModal.modal(),e.userModal.setSelect(e.state.joinable_emails),e.userModal.setOnSelect((function(t){return e.setState({joinable_emails:t})}))}})),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement("div",{className:"input_item_text"},lang("who_edit_lab")),o.a.createElement("div",{className:"button input_item_option",select:0==this.state.editable?"true":"false",onClick:function(){return e.setState({editable:0})}},o.a.createElement("i",{className:"fa icon"}),"  ",lang("Admin Only")),o.a.createElement("div",{className:"button input_item_option",select:1==this.state.editable?"true":"false",onClick:function(){return e.setState({editable:1})}},o.a.createElement("i",{className:"fa icon"}),"  ",lang("Everyone")),o.a.createElement("div",{className:"button input_item_option",select:2==this.state.editable?"true":"false",onClick:function(){return e.setState({editable:2})}},o.a.createElement("i",{className:"fa icon"}),"  ",lang("Admin and Special users")),o.a.createElement("textarea",{disabled:2!=this.state.editable,readOnly:!0,className:"input_item_input",value:this.showUsers(this.state.editable_emails),onClick:function(){e.userModal.modal(),e.userModal.setSelect(e.state.editable_emails),e.userModal.setOnSelect((function(t){return e.setState({editable_emails:t})}))}})))),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},lang("Close")),o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){e.editLab()}},lang("Save"))))),o.a.createElement("style",null,'\n               \n                .lab_item{\n                    margin: 7px 0px;\n                }\n                .input_item_text{\n                    font-weight: bold;\n                }\n\n                .input_item_option[select=true] .icon:before {\n                    content: "\\f192";\n                }\n                .input_item_option[select=false] .icon:before {\n                    content: "\\f10c"\n                }\n                .input_item_option .icon{\n                    color: rgb(23, 162, 184);\n                    font-size: 16px;\n                }\n\n\n\n            '),o.a.createElement(s.a,{ref:function(t){return e.userModal=t}}))}},{key:"editLab",value:function(){var e=this,t={author:this.authorInput.getValue(),description:this.descriptionInput.getValue(),scripttimeout:this.scripttimeoutInput.getValue(),countdown:this.countdownInput.getValue(),version:this.versionInput.getValue(),openable:this.state.openable,openable_emails:this.state.openable_emails,joinable:this.state.joinable,joinable_emails:this.state.joinable_emails,editable:this.state.editable,editable_emails:this.state.editable_emails};this.loading.loading(!0),axios({method:"POST",url:"/api/labs/edit",dataType:"json",data:{path:this.path,data:t}}).then((function(t){e.loading.loading(!1),"success"==(t=t.data).status?(previewLab(e.path),e.modal("hide")):error_handle(t)})).catch((function(t){e.loading.loading(!1),console.log(t),error_handle(t.response)}))}},{key:"loadLab",value:function(){var e=this;this.loading.loading(!0),axios({method:"POST",url:"/api/labs/get",dataType:"json",data:{path:this.path}}).then((function(t){if(e.loading.loading(!1),"success"==(t=t.data).status){var n=t.data;isset(n.version)&&e.versionInput.setValue(n.version),isset(n.author)&&e.authorInput.setValue(n.author),isset(n.scripttimeout)&&e.scripttimeoutInput.setValue(n.scripttimeout),isset(n.countdown)&&e.countdownInput.setValue(n.countdown);var a=get(n.openable,0),o=get(n.joinable,0),i=get(n.editable,0);""==a&&(a=0),""==o&&(o=0),""==i&&(o=0);var l=get(n.openable_emails,[]),s=get(n.joinable_emails,[]),r=get(n.editable_emails,[]);e.setState({openable_emails:l,joinable_emails:s,editable_emails:r,openable:a,joinable:o,editable:i})}else error_handle(t)})).catch((function(t){e.loading.loading(!1),console.log(t),error_handle(t)}))}}])&&d(a.prototype,r),c&&d(a,c),n}(a.Component);t.a=m}).call(this,n(1))},531:function(e,t,n){"use strict";(function(e){var a=n(0),o=n.n(a),i=n(532),l=n(13),s=(n(603),n(87)),r=n(88),c=n(84);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e){return(d="function"==typeof Symbol&&"symbol"===u(Symbol.iterator)?function(e){return u(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":u(e)})(e)}function p(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function h(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=h(this,f(n).call(this,e))).id="comp"+makeId(),t.state={path:"",zoom:100,lab:{},width:"max-content",height:"max-content"},t}var a,u,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(n,t),a=n,(u=[{key:"render",value:function(){var e=this,t="";return 0==this.state.lab.nogrid?(1==this.state.lab.darkmode&&1==this.state.lab.mode3d&&(t+="dark3d"),1==this.state.lab.darkmode&&0==this.state.lab.mode3d&&(t+="dark2d"),0==this.state.lab.darkmode&&1==this.state.lab.mode3d&&(t+="light3d"),0==this.state.lab.darkmode&&0==this.state.lab.mode3d&&(t+="light2d")):(1==this.state.lab.darkmode&&(t+="dark"),0==this.state.lab.darkmode&&(t+="light")),""==t&&(t="light2d"),this.backgroundcss=t,o.a.createElement("div",{style:{width:"100%"}},o.a.createElement("div",{className:"box_flex lab_preview_title"},o.a.createElement("i",{className:"fa fa-mortar-board"})," ",lang("Lab Preview")),o.a.createElement("div",{id:"lab_preview_frame",className:t},o.a.createElement("div",{style:{position:"absolute",top:5,bottom:5,right:5,zIndex:5,display:"flex",flexDirection:"column"}},o.a.createElement("i",{className:"button fa fa-search-plus",style:{marginBottom:5,color:"#17a2b8"},onClick:function(){Number(e.state.zoom)<200&&e.setState({zoom:Number(e.state.zoom)+10})}}),o.a.createElement("input",{style:{height:"100%",width:15},orient:"vertical",type:"range",min:"10",max:"200",value:this.state.zoom,onChange:function(t){e.setState({zoom:Number(t.target.value)})}}),o.a.createElement("i",{className:"button fa fa-search-minus",style:{marginTop:5,color:"#17a2b8"},onClick:function(){Number(e.state.zoom)>10&&e.setState({zoom:Number(e.state.zoom)-10})}})),o.a.createElement("div",{className:"box_flex",style:{position:"absolute",bottom:5,left:5,zIndex:5}},o.a.createElement("i",{style:{padding:5},title:lang("Print"),className:"button fa fa-print",onClick:function(){return e.printTopology()}}),o.a.createElement("i",{style:{padding:5},title:lang("Snapshot"),className:"button fa fa-image",onClick:function(){return e.snapshotTopology()}})),o.a.createElement(l.a,{ref:function(t){return e.loading=t},style:{position:"absolute"}}),o.a.createElement("div",{id:"lab_dragable",style:{overflow:"hidden",display:"block",width:this.state.width,height:this.state.height,transformOrigin:"0 0",transform:"scale(".concat(this.state.zoom/100,")")}},o.a.createElement(i.a,{backgroundcss:t,key:this.state.path,path:this.state.path,onStart:function(){e.loading.loading(!0)},onLoad:function(){e.loading.loading(!1)},onResize:function(t,n){e.resetZoom(t,n)}}))),""==this.state.path?"":o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"box_flex",style:{marginTop:5}},o.a.createElement("div",{className:"btn btn-sm btn-info",onClick:function(){openLab(e.state.path)}},o.a.createElement("i",{className:"fa fa-folder-open"})," ",lang("Open"))," ",o.a.createElement("div",{className:"btn btn-sm btn-info",onClick:function(){editLab(e.state.path)}},o.a.createElement("i",{className:"fa fa-edit"})," ",lang("Edit"))," ",o.a.createElement("div",{className:"btn btn-sm btn-danger",onClick:function(){e.delLab(e.state.path)}},o.a.createElement("i",{className:"fa fa-trash"})," ",lang("Delete"))," "),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement("table",{id:"lab_info_table"},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("i",{className:"fa fa-circle"})),o.a.createElement("td",null,lang("Lab Name")),o.a.createElement("td",null,":"),o.a.createElement("th",null,this.state.lab.name)),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("i",{className:"fa fa-circle"})),o.a.createElement("td",null,lang("Author")),o.a.createElement("td",null,":"),o.a.createElement("th",null,this.state.lab.author)),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("i",{className:"fa fa-circle"})),o.a.createElement("td",null,lang("Version")),o.a.createElement("td",null,":"),o.a.createElement("th",null,this.state.lab.version)),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("i",{className:"fa fa-circle"})),o.a.createElement("td",null,lang("Lab ID")),o.a.createElement("td",null,":"),o.a.createElement("th",null,this.state.lab.id)),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("i",{className:"fa fa-circle"})),o.a.createElement("td",null,lang("Desciption")),o.a.createElement("td",null,":"),o.a.createElement("td",null,this.state.lab.description)))))),o.a.createElement(s.a,null),o.a.createElement(r.a,{ref:function(e){return App.lineControl=e}}),o.a.createElement(c.a,{src:"/store/public/extensions/domtoimg/domtoimg.js"}))}},{key:"printTopology",value:function(){if(document.getElementById("lab-viewport")){var e=window.open("","_blank");e.document.outerHTML="",e.document.write("<html>".concat(document.getElementsByTagName("head")[0].outerHTML,"<body>")),e.document.write('<div style="height:100%; justify-content: center; align-items: center; display: flex;" class=\''.concat(this.backgroundcss,"'>\n            <div style=\"width:").concat(this.state.width,"; height:").concat(this.state.height,'; position:relative">\n            ').concat(document.getElementById("lab-viewport").outerHTML,"\n            </div>\n        </div>"));var t=document.getElementsByTagName("style");for(var n in t)t[n].outerHTML&&e.document.write(t[n].outerHTML);return e.document.write('<style media="print">\n                                @page { \n                                    size: '.concat(this.state.width," ").concat(this.state.height,";\n                                    margin: 0;\n                                }\n                            </style>")),e.document.write("</body></html>"),e.document.close(),e.addEventListener("load",(function(){e.focus(),e.print()})),!0}}},{key:"snapshotTopology",value:function(){var e=this,t=document.getElementById("lab-viewport");if(t)return App.loading(!0),t.classList.add(this.backgroundcss),domtoimage.toPng(t).then((function(n){t.classList.remove(e.backgroundcss);var a=document.createElement("a");a.href=n,a.download=e.state.lab.name+".png",document.body.appendChild(a),a.click(),document.body.removeChild(a),App.loading(!1)})),!0}},{key:"componentDidMount",value:function(){var t=this;e.previewLab=function(e){t.setState({path:e}),""!=e&&t.loadLab(e)},$("#lab_dragable").draggable()}},{key:"resetZoom",value:function(e,t){var n=document.getElementById("lab_preview_frame").clientWidth,a=document.getElementById("lab_preview_frame").clientHeight,o=document.getElementById("lab_dragable");o.style.top="0px",o.style.left="0px";var i=100*Number(n)/Number(e),l=100*Number(a)/Number(t),s=i>l?l:i;n>0&&e>0&&this.setState({zoom:s,width:e+"px",height:t+"px"})}},{key:"loadLab",value:function(e){var t=this;if(isset(e)&&""!=e)return axios.request({url:"/api/labs/get",method:"post",data:{path:e}}).then((function(e){if("success"==(e=e.data).status){var n=e.data;t.setState({lab:n})}else error_handle(e)})).catch((function(e){console.log(e),error_handle(e)}))}},{key:"delLab",value:function(t){var n=this;isset(t)&&""!=t&&confirm("Are you sure you want to delete this lab: "+t)&&e.delLab&&e.delLab(t,(function(){n.setState({path:""}),e.scope&&e.scope.fileMngDraw(e.scope.path)}))}}])&&p(a.prototype,u),d&&p(a,d),n}(a.Component);t.a=b}).call(this,n(1))},532:function(e,t,n){"use strict";var a=n(0),o=n.n(a),i=(n(13),n(192));function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){return(s="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(e){return l(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":l(e)})(e)}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=c(this,u(t).call(this,e))).id=makeId(),n.minLeft=0,n.minTop=0,n.maxLeft=0,n.maxTop=0,n.padding=15,n}var n,a,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),n=t,(a=[{key:"loadLab",value:function(e){var t=this;if(isset(e)&&""!=e)return this.props.onStart&&this.props.onStart(),axios.request({url:"/api/labs/preview",method:"post",data:{path:e}}).then((function(e){t.props.onLoad&&t.props.onLoad();var n=e.data.data;return t.setData(n),!0})).catch((function(e){return t.props.onLoad&&t.props.onLoad(),error_handle(e),!1}))}},{key:"setData",value:function(e){var t=this;this.topology.setData(e),this.topology.printTopology().then((function(){var e=document.getElementById("lab-viewport").querySelectorAll([".customShape",".node",".network"]);for(var n in e){var a=e[n],o=a.offsetTop,i=a.offsetLeft,l=a.offsetWidth,s=a.offsetHeight;0==n?(t.minLeft=i,t.minTop=o,t.maxLeft=i+l,t.maxTop=o+s):(i<t.minLeft&&(t.minLeft=i),i+l>t.maxLeft&&(t.maxLeft=i+l),o<t.minTop&&(t.minTop=o),o+s>t.maxTop&&(t.maxTop=o+s))}t.minLeft=Number(t.minLeft)-t.padding,t.minTop=Number(t.minTop)-t.padding,t.maxLeft=Number(t.maxLeft)+t.padding,t.maxTop=Number(t.maxTop)+t.padding,t.forceUpdate((function(){t.props.onResize&&t.props.onResize(t.maxLeft-t.minLeft,t.maxTop-t.minTop)}))}))}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"lab-viewport",style:{overflow:"hidden",position:"relative",pointerEvents:"none",height:this.maxTop,width:this.maxLeft,top:-this.minTop,left:-this.minLeft}}))}},{key:"componentDidMount",value:function(){this.topology=new i.a(!0);var e=this.props.path;this.loadLab(e)}}])&&r(n.prototype,a),l&&r(n,l),t}(a.Component);t.a=p},603:function(e,t,n){var a=n(604);"string"==typeof a&&(a=[[e.i,a,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(19)(a,o);a.locals&&(e.exports=a.locals)},604:function(e,t,n){(e.exports=n(18)(!1)).push([e.i,'.light2d {\n  background-image: url("/themes/default/images/background/light_2D.png");\n}\n\n.dark2d {\n  background-image: url("/themes/default/images/background/dark_2D.png");\n}\n.dark2d .node_name {\n  color: white;\n}\n.dark2d .network_name {\n  color: white;\n}\n\n.light3d {\n  background-image: url("/themes/default/images/background/light_3D.png");\n}\n\n.dark3d {\n  background-image: url("/themes/default/images/background/dark_3D.png");\n}\n.dark3d .node_name {\n  color: white;\n}\n.dark3d .network_name {\n  color: white;\n}\n\n.dark {\n  background: #28353c;\n}\n.dark .node_name {\n  color: white;\n}\n.dark .network_name {\n  color: white;\n}\n\n#lab_dragable {\n  cursor: move;\n}\n\n#lab_preview_frame {\n  height: 450px;\n  position: relative;\n  overflow: hidden;\n  border: solid thin #ccc;\n}\n\n.lab_preview_title {\n  padding-bottom: 5px;\n  font-weight: bold;\n  color: #0d274d;\n  font-size: 18px;\n}\n\n#lab_info_table td, #lab_info_table th {\n  padding: 5px;\n}\n\n#lab_info_table i {\n  font-size: 8px;\n  color: #17a2b8;\n}\n\ninput[type=range][orient=vertical] {\n  writing-mode: bt-lr;\n  /* IE */\n  -webkit-appearance: slider-vertical;\n  /* WebKit */\n}\n\n.tag.hidden {\n  display: none;\n}',""])},614:function(e,t,n){"use strict";n.r(t),function(e){var a=n(0),o=n.n(a),i=n(521),l=(n(522),n(95)),s=n(91),r=n(92),c=n(209),u=(n(597),n(523)),d=(n(598),n(524),n(93)),p=n(94),h=(n(740),n(531)),f=(n(96),n(530)),m=n(525),b=n(6);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e){return(y="function"==typeof Symbol&&"symbol"===g(Symbol.iterator)?function(e){return g(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":g(e)})(e)}function v(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=function(t){function n(e){var t,a,i,l,s,r,u,d,p,h,f,m;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(m=w(this,S(n).call(this,e))).state={running:{},preview:"false"!=localStorage.getItem("lab_preview"),consume:{},hide_idlelab:!1},m.lab_sessions_struct={},m.lab_sessions_struct[STRUCT_FILTERS]={},m.lab_sessions_struct[STRUCT_COLUMNS]=(p={actions:(t={},_(t,COL_NAME,"Actions"),_(t,COL_SORT,!1),_(t,COL_DECORATOR_IN,(function(e,t,n){var a=n[t][LAB_SESSION_ID];return o.a.createElement("div",{className:"box_flex",style:{justifyContent:"center"}},o.a.createElement("div",{className:"button lab_session_button",title:lang("Join Lab Session"),onClick:function(){m.joinLabSession(a)}},o.a.createElement("i",{className:"fa fa-sign-in"}))," ",o.a.createElement("div",{className:"button lab_session_button",title:lang("Stop all Nodes"),onClick:function(){m.stopLabSession(a)}},o.a.createElement("i",{className:"fa fa-stop"}))," ",o.a.createElement("div",{className:"button lab_session_button",title:lang("Destroy Lab Session"),onClick:function(){m.destroyLabSession(a)}},o.a.createElement("i",{className:"fa fa-chain-broken"})))})),_(t,COL_STYLE,{textAlign:"center"}),t)},_(p,LAB_SESSION_PATH,(_(a={},COL_NAME,lang(LAB_SESSION_PATH)),_(a,COL_SORT,!1),_(a,COL_DECORATOR_IN,(function(e,t,n){var a=n[t][e],i=n[t];return o.a.createElement("div",{className:"button box_line",style:{color:a==m.selectLab?"#4CAF50":"rgb(23, 162, 184)",fontWeight:"bold"},onClick:function(){m.selectLab=a,previewLab(a),m.table.reload(),m.setState({preview:!0})},title:a,"data-toggle":"tooltip"},i[LAB_SESSION_RUNNING]>0?o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fa fa-play",style:{color:"#00d108"}})," ",a):o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fa fa-stop",style:{color:"red"}})," ",a))})),a)),_(p,LAB_SESSION_RUNNING,(_(i={},COL_NAME,lang(LAB_SESSION_RUNNING)),_(i,COL_SORT,!0),_(i,COL_DECORATOR_IN,(function(e){return e>0?o.a.createElement("b",{style:{color:"#00d108"}},e):o.a.createElement("b",{style:{color:"#00d108"}},"0")})),_(i,COL_STYLE,{textAlign:"center"}),i)),_(p,LAB_SESSION_POD,(_(l={},COL_NAME,lang(LAB_SESSION_POD)),_(l,COL_SORT,!0),_(l,COL_DECORATOR_IN,(function(e){if(!m.users[e])return e;var t=moment().format("X"),n=Number(t)-Number(m.users[e][USER_ONLINE_TIME]),a=moment(m.users[e][USER_ONLINE_TIME],"X").format("llll");return"Invalid date"==a&&(a=""),n<600?o.a.createElement("span",{style:{textAlign:"left"}},o.a.createElement("i",{title:"Online: "+a,className:"fa fa-circle",style:{color:"green",cursor:"pointer"}})," ",o.a.createElement("b",{title:m.users[e][USER_EMAIL]},formatName(m.users[e][USER_USERNAME]))):o.a.createElement("span",{style:{textAlign:"left"}},o.a.createElement("i",{title:"Offline: "+a,className:"fa fa-circle",style:{color:"red",cursor:"pointer"}})," ",o.a.createElement("b",{title:m.users[e][USER_EMAIL]},formatName(m.users[e][USER_USERNAME])))})),l)),_(p,LAB_SESSION_JOINED,(_(s={},COL_NAME,lang(LAB_SESSION_JOINED)),_(s,COL_SORT,!1),_(s,COL_DECORATOR_IN,(function(e){var t=e.split(",");t.length;return t=t.map((function(e,t){var n=e.trim();if(!m.users[n])return n;var a=moment().format("X"),i=Number(a)-Number(m.users[n][USER_ONLINE_TIME]),l=moment(m.users[n][USER_ONLINE_TIME],"X").format("llll");return"Invalid date"==l&&(l=""),i<600?o.a.createElement("span",{key:t,style:{textAlign:"left",marginRight:5}},o.a.createElement("i",{title:"Online: "+l,className:"fa fa-circle",style:{color:"green",cursor:"pointer"}})," ",o.a.createElement("b",{title:m.users[n][USER_EMAIL]},formatName(m.users[n][USER_USERNAME]))):o.a.createElement("span",{key:t,style:{textAlign:"left",marginRight:5}},o.a.createElement("i",{title:"Offline: "+l,className:"fa fa-circle",style:{color:"red",cursor:"pointer"}})," ",o.a.createElement("b",{title:m.users[n][USER_EMAIL]},formatName(m.users[n][USER_USERNAME])))}))})),s)),_(p,"consume_cpu",(_(r={},COL_NAME,"CPU"),_(r,COL_SORT,!0),_(r,COL_STYLE,{minWidth:100}),_(r,COL_DECORATOR_IN,(function(e,t,n){var a=n[t][LAB_SESSION_ID];if(!m.state.consume[a])return"";var i=Math.round(100*m.state.consume[a].cpu)/100;return o.a.createElement("div",{className:"progress",style:{margin:0,width:"100%",height:"unset"}},o.a.createElement("div",{className:"progress-bar",style:{width:"".concat(i,"%"),lineHeight:"unset",background:i>80?"red":i>50?"orange":"green"}}," ","".concat(i,"%")))})),r)),_(p,"consume_ram",(_(u={},COL_NAME,"RAM"),_(u,COL_SORT,!0),_(u,COL_STYLE,{minWidth:100}),_(u,COL_DECORATOR_IN,(function(e,t,n){var a=n[t][LAB_SESSION_ID];if(!m.state.consume[a])return"";var i=Math.round(100*m.state.consume[a].ram)/100;return o.a.createElement("div",{className:"progress",style:{margin:0,width:"100%",height:"unset"}},o.a.createElement("div",{className:"progress-bar",style:{width:"".concat(i,"%"),lineHeight:"unset",background:i>80?"red":i>50?"orange":"green"}}," ","".concat(i,"%")))})),u)),_(p,"consume_hdd",(_(d={},COL_NAME,"Hard Disk"),_(d,COL_SORT,!0),_(d,COL_STYLE,{textAlign:"center",fontWeight:"bold"}),_(d,COL_DECORATOR_IN,(function(e,t,n){var a=n[t][LAB_SESSION_ID];return m.state.consume[a]?Math.round(100*m.state.consume[a].hdd)/100+"MB":""})),d)),p),m.lab_sessions_struct[STRUCT_EDIT]={},m.lab_sessions_struct[STRUCT_FILTERS]=_({},LAB_SESSION_PATH,(_(h={},FILTER_NAME,lang(LAB_SESSION_PATH)),_(h,FILTER_TYPE,"text"),h)),m.lab_sessions_struct[STRUCT_ROWS]=_({},ROW_FUNCS,(function(e){return[o.a.createElement(c.a,{key:1,rowData:e})]})),m.lab_sessions_struct[STRUCT_TABLE]=(_(f={},DATA_TABLE_ID,LAB_SESSIONS_TABLE),_(f,DATA_FILTERS,{}),_(f,DATA_HIDDEN_COL,{}),_(f,DATA_PERMIT_COL,m.permissionLab_sessions()),_(f,DATA_KEY,[LAB_SESSION_ID]),_(f,DATA_SORT,_({},LAB_SESSION_ID,"desc")),_(f,FLAG_FILTER_CHANGE,!0),_(f,FLAG_MULTI_SORT,!1),_(f,FLAG_RESIZABLE,!0),_(f,FLAG_SELECT_ROWS,!1),_(f,FLAG_SETTING_ROWS,!1),_(f,FLAG_EXPAND_ROWS,!1),_(f,FLAG_HEAD_ROW,!0),_(f,LINK_FILTER,"/store/public/admin/lab_sessions/filter"),f),m.selectLab="",m.users={},m}var a,g,y;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(n,t),a=n,(g=[{key:"permissionLab_sessions",value:function(){return Object.assign.apply(Object,v(Object.keys(this.lab_sessions_struct[STRUCT_COLUMNS]).map((function(e,t){return _({},e,"Read")}))).concat(v(Object.keys(this.lab_sessions_struct[STRUCT_EDIT]).map((function(e,t){return _({},e,"Write")})))))}},{key:"getMapUser",value:function(){var e=this;return axios.request({url:"/store/public/admin/lab_sessions/mapUser",method:"post"}).then((function(t){if(App.loading(!1),!(t=t.data).result)return error_handle(t),!1;e.users=t.data,e.table.reload()})).catch((function(e){console.log(e),App.loading(!1),error_handle(e)}))}},{key:"destroyLabSession",value:function(t){var n=this;e.destroyLabSession&&e.destroyLabSession(t).then((function(e){e&&(n.table.filter(),localStorage.removeItem("countdown_timer_".concat(t)))}))}},{key:"stopLabSession",value:function(t){var n=this;e.stopNodesLabSession&&e.stopNodesLabSession(t).then((function(e){e&&(n.table.filter(),localStorage.removeItem("countdown_timer_".concat(t)))}))}},{key:"joinLabSession",value:function(e){return App.loading(!0),axios.request({url:"/api/labs/session/factory/join",method:"post",dataType:"json",data:{lab_session:e}}).then((function(e){App.loading(!1),window.location.href="/legacy/topology"})).catch((function(e){console.log(e),App.loading(!1),error_handle(e)}))}},{key:"getRunningNodes",value:function(){var e=this;return axios.request({url:"/api/nodestatus",method:"post",dataType:"json"}).then((function(t){if((t=t.data)[!1])return error_handle(t),!1;var n=t.data,a={};for(var o in n){var i=n[o];a[i[NODE_SESSION_LAB]]||(a[i[NODE_SESSION_LAB]]={running:!1,started:0}),i.node_session_status>1&&(a[i[NODE_SESSION_LAB]].running=!0,a[i[NODE_SESSION_LAB]].started++)}e.setState({running:a})})).catch((function(e){console.log(e),error_handle(e)}))}},{key:"getConsume",value:function(){var e=this;return axios.request({url:"/store/public/admin/node_sessions/getConsume",method:"post"}).then((function(t){if(App.loading(!1),(t=t.data).result){var n=t.data,a={};for(var o in n){var i=n[o];a[i[NODE_SESSION_LAB]]||(a[i[NODE_SESSION_LAB]]={ram:0,cpu:0,hdd:0}),a[i[NODE_SESSION_LAB]].ram+=Number(i[NODE_SESSION_RAM]),a[i[NODE_SESSION_LAB]].cpu+=Number(i[NODE_SESSION_CPU]),a[i[NODE_SESSION_LAB]].hdd+=Number(i[NODE_SESSION_HDD]),e.setState({consume:a})}}else error_handle(t)})).catch((function(e){console.log(e),App.loading(!1),error_handle(e)}))}},{key:"componentDidMount",value:function(){var e=this;this.getMapUser(),this.getConsume(),this.intervalId=setInterval((function(){e.getConsume().then((function(t){e.table.filter(null,!1)}))}),3e4),this.mapUserInteval=setInterval((function(){e.getMapUser()}),3e5)}},{key:"componentWillUnmount",value:function(){this.intervalId&&clearInterval(this.intervalId),this.mapUserInteval&&clearInterval(this.mapUserInteval)}},{key:"render",value:function(){var e,t=this;return o.a.createElement("div",{className:"row"},o.a.createElement("div",{style:{padding:7},className:"col-md-".concat(this.state.preview?"6":"12"," order-md-0 order-1")},o.a.createElement("div",{className:"box_flex lab_preview_title"},o.a.createElement("i",{className:"fa fa-cogs"})," ",lang("Running Lab Sessions"),o.a.createElement("i",{className:"fa fa-border button ".concat(this.state.preview?"fa-expand":"fa-compress"),style:{margin:"auto 0px auto auto",padding:"5px 8px",borderRadius:2},onClick:function(){var e=t.state.preview;localStorage.setItem("lab_preview",!e),t.setState({preview:!e})}})),o.a.createElement(i.a,{ref:function(e){return t.table=e},table:this.lab_sessions_struct,autoload:!0},o.a.createElement("div",{className:"lab_session_filter_item"},o.a.createElement(b.a,{struct:(e={},_(e,INPUT_TYPE,"text"),_(e,INPUT_ONCHANGE_BLUR,(function(e,n){console.log(n),t.table[STRUCT_TABLE][DATA_FILTERS][LAB_SESSION_PATH]={logic:"and",data:[["contain",n.getValue()]]},t.table.filter()})),e),placeholder:"Search Lab",style:{width:"100%"},className:"input"})),o.a.createElement(r.a,{left:o.a.createElement(u.a,null),right:o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"box_flex button",onClick:function(){t.state.hide_idlelab?delete t.table[STRUCT_TABLE][DATA_FILTERS][LAB_SESSION_RUNNING]:t.table[STRUCT_TABLE][DATA_FILTERS][LAB_SESSION_RUNNING]={logic:"and",data:[[">",0]]},t.table.filter(),t.setState({hide_idlelab:!t.state.hide_idlelab})}},o.a.createElement("i",{style:{color:"#457fca"},className:"button fa ".concat(this.state.hide_idlelab?"fa-toggle-on":"fa-toggle-off")}),lang("Hide Idle Labs")),o.a.createElement(d.a,null),o.a.createElement(p.a,null))}),o.a.createElement(l.a,{className:"table table-bordered table-resizable",frameStyle:{maxHeight:"75vh"}}),o.a.createElement(s.a,null))),o.a.createElement("div",{className:"col-md-6 order-md-1 order-0",style:{display:this.state.preview?"block":"none",padding:7}},o.a.createElement(h.a,null),o.a.createElement(f.a,null)),o.a.createElement("style",null,"\n\t\t\t\t\t\t.lab_session_filter_item .filter_item{\n\t\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\t\tpadding: 0px;\n\t\t\t\t\t\t\tmargin: 5px 0px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#lab_sessions th {\n\t\t\t\t\t\t\tbackground: #0d274d;\n\t\t\t\t\t\t\tcolor: white;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.lab_session_button {\n\t\t\t\t\t\t\tpadding: 4px 5px;\n\t\t\t\t\t\t\tborder: solid thin darkgray;\n\t\t\t\t\t\t\tborder-radius: 3px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t"),o.a.createElement(m.a,{callback:function(e){null!=e&&""!=e&&(window.location="/legacy/topology")}}))}}])&&E(a.prototype,g),y&&E(a,y),n}(a.Component);t.default=x}.call(this,n(1))},740:function(e,t,n){"use strict";var a=n(0),o=n.n(a);n(13);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return(l="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}a.Component},80:function(e,t,n){"use strict";var a=n(33);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var s=function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t)this[n]=t[n];var o=get(t.ethernets,{}),i=get(t.serials,{});for(var l in this.ethernets={},this.serials={},o)this.ethernets[l]=new a.a(o[l],"ethernet");for(var s in i)this.serials[s]=new a.a(i[s],"serial");$("#node"+t.id).length&&(this.component=$("#node"+t.id))}var t,n,s;return t=e,(n=[{key:"getInterfaces",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(n,!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.ethernets,{},this.serials)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return void 0!==this[e]?this[e]:t}}])&&l(t.prototype,n),s&&l(t,s),e}();t.a=s},81:function(e,t,n){"use strict";var a=n(33);function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t)this[n]=t[n];this.endpoints=[],$("#network"+t.id).length&&(this.component=$("#network"+t.id))}var t,n,i;return t=e,(n=[{key:"createLinks",value:function(){var e=this;if(0==this.endpoints.length&&0==this.get("visibility"))return App.topology.registerUnuseNetwork(this.get("id")),[];if(1==this.endpoints.length&&0==this.get("visibility"))return App.topology.registerUnuseNetwork(this.get("id")),[];if(2==this.endpoints.length&&0==this.get("visibility"))return[{source:this.endpoints[0],dest:this.endpoints[1],id:"network_id:".concat(this.endpoints[0].interface.get("network_id"))}];this.visibility=1;var t=[];return this.endpoints.map((function(n){t.push({source:n,dest:{node:e,interface:new a.a({type:"network"}),type:"ethernet"},id:"iface:node".concat(n.node.get("id"),":").concat(n.interface.get("id"))})})),t}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return void 0!==this[e]?this[e]:t}}])&&o(t.prototype,n),i&&o(t,i),e}();t.a=i},82:function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t)this[n]=t[n]}var t,n,o;return t=e,(n=[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return void 0!==this[e]?this[e]:t}}])&&a(t.prototype,n),o&&a(t,o),e}();t.a=o},83:function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t)this[n]=t[n];this.params=t}var t,n,o;return t=e,(n=[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return void 0!==this[e]?this[e]:t}}])&&a(t.prototype,n),o&&a(t,o),e}();t.a=o},87:function(e,t,n){"use strict";(function(e){var a=n(0),o=n.n(a),i=n(46),l=n(195),s=n(196);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){return(c="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)})(e)}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=d(this,p(n).call(this,e))).type={Straight:"Straight",Bezier:"Bezier",Flowchart:"Flowchart",StateMachine:"State Machine"},t.style={solid:"border_style_solid",dashed:"border_style_dashed",dotted:"border_style_dotted",dotdash:"border_style_dotdash"},t.id=makeId(),t.state={type:"Straight",color:"#0066aa",style:"solid",label:"",width:"",fontsize:"",stub:"",curviness:"",midpoint:.5,cornerRadius:"",show:!1},t.original={},t.connection=null,t.labPath=$("#lab-viewport").attr("data-path"),t.moveControl=new s.a((function(e,n){e.classList.contains("link_label")?t.labelpos=n:e.classList.contains("node_interface")&&"src"==e.getAttribute("position")?t.srcpos=n:e.classList.contains("node_interface")&&"dst"==e.getAttribute("position")&&(t.dstpos=n),t.applyObjectToConnection(e)})),t.labelpos=null,t.dstpos=null,t.srcpos=null,t}var a,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(n,t),a=n,(r=[{key:"applyObjectToConnection",value:function(e){e.classList.contains("link_label")?this.connection.setLabel(e.outerHTML):e.classList.contains("node_interface")&&"src"==e.getAttribute("position")?this.srcLabel&&this.srcLabel.setLabel(e.outerHTML):e.classList.contains("node_interface")&&"dst"==e.getAttribute("position")&&this.dstLabel&&this.dstLabel.setLabel(e.outerHTML)}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement("style",null,"\n                .border_style_solid{\n                    stroke-dasharray: none;\n                }\n\n                .border_style_dashed{\n                    stroke-dasharray: 5,5;\n                }\n\n                .border_style_dotted{\n                    stroke-linecap: round;\n                    stroke-dasharray: 1,5;\n                }\n\n                .border_style_dotdash{\n                    stroke-linecap: round;\n                    stroke-dasharray: 1,5,10,5;\n                }\n\n                .link_ctl_frame{\n                    background-color: white;\n                    position: fixed;\n                    top: 0px;\n                    left: 0px;\n                    right: 0px;\n                    z-index: 2000;\n                    display: none;\n                    padding: 5px 5px 10px 5px;\n                    transition: all 0.2s ease-out;\n                }\n                .link_ctl_input{\n                    height:30px;\n                    width: 100px;\n                    margin-top: 5px;\n                    border: solid thin darkgray;\n                    border-radius: 4px;\n                    padding: 5px;\n                    text-shadow: white -1px 0px, white 0px 1px, white 1px 0px, white 0px -1px;\n                }\n                .link_ctl_item{\n                    margin: 5px;\n                }\n\n                .link_ctl_item .link_ctl_title{\n                    color: #346789;\n                    font-weight:bold;\n                }\n                #lab-viewport .link_label {\n                    background-color: #e6f5ff;\n                    border: 2px solid #346789;\n                    border-radius: 2px;\n                    font-family: helvetica;\n                    font-size: 0.8em;\n                    font-weight: bold;\n                    padding: 0px 2px 0px 2px;\n                }\n\n                .lable_draggable{\n                    cursor: move;\n                    background: orange !important;\n                }\n\n                .label_hide{\n                    display: none;\n                }\n                .lable_draggable.label_hide{\n                    display: block;\n                    opacity: 0.2;\n                }\n\n            "),o.a.createElement("div",{ref:function(t){return e.dom=t},className:"box_shadow link_ctl_frame",style:{display:this.state.show?"block":"none"}},o.a.createElement("div",{className:"box_flex"},o.a.createElement("div",{className:"link_ctl_item"},o.a.createElement("div",{className:"box_line link_ctl_title"},lang("Type")),o.a.createElement("select",{className:"link_ctl_input",value:this.state.type,onChange:function(t){e.setState({type:t.target.value},(function(){return e.updateType()}))}},Object.keys(this.type).map((function(t){return o.a.createElement("option",{key:t,value:t},e.type[t])})))),o.a.createElement("div",{className:"link_ctl_item",style:{display:"Straight"==this.state.type||"Flowchart"==this.state.type?"block":"none"}},o.a.createElement("div",{className:"box_line link_ctl_title"},lang("Stub")),o.a.createElement("input",{className:"link_ctl_input",type:"number",value:this.state.stub,onChange:function(t){e.setState({stub:t.target.value},(function(){e.updateType()}))}})),o.a.createElement("div",{className:"link_ctl_item",style:{display:"Bezier"==this.state.type||"StateMachine"==this.state.type?"block":"none"}},o.a.createElement("div",{className:"box_line link_ctl_title"},lang("Curviness")),o.a.createElement("input",{className:"link_ctl_input",step:"5",type:"number",value:this.state.curviness,onChange:function(t){e.setState({curviness:t.target.value},(function(){e.updateType()}))}})),o.a.createElement("div",{className:"link_ctl_item",style:{display:"Flowchart"==this.state.type?"block":"none"}},o.a.createElement("div",{className:"box_line link_ctl_title"},lang("Round")),o.a.createElement("input",{className:"link_ctl_input",type:"number",value:this.state.cornerRadius,onChange:function(t){e.setState({cornerRadius:t.target.value},(function(){e.updateType()}))}})),o.a.createElement("div",{className:"link_ctl_item",style:{display:"Flowchart"==this.state.type?"block":"none"}},o.a.createElement("div",{className:"box_line link_ctl_title"},lang("Mid Point")),o.a.createElement("div",{className:"link_ctl_input box_flex",style:{width:150}},o.a.createElement("input",{style:{width:"100%"},type:"range",name:"vol",min:"0",max:"100",value:100*this.state.midpoint,onChange:function(t){e.setState({midpoint:t.target.value/100},(function(){e.updateType()}))}}))),o.a.createElement("div",{className:"link_ctl_item"},o.a.createElement("div",{className:"box_line link_ctl_title"},lang("Color")),o.a.createElement("div",{className:"dropdown"},o.a.createElement("input",{value:this.state.color,style:{backgroundColor:this.state.color},onChange:function(t){e.onChangeColor(t.target.value)},className:"dropdown-toggle link_ctl_input","data-toggle":"dropdown"}),o.a.createElement("div",{className:"dropdown-menu",id:"color".concat(this.id),style:{padding:0}},o.a.createElement(i.SketchPicker,{color:this.state.color,onChangeComplete:function(t){t=t.rgb;var n="rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")");e.onChangeColor(n)}})))),o.a.createElement("div",{className:"link_ctl_item"},o.a.createElement("div",{className:"box_line link_ctl_title"},lang("Style")),o.a.createElement("div",{className:"dropdown"},o.a.createElement("div",{className:"dropdown-toggle box_flex link_ctl_input","data-toggle":"dropdown"},o.a.createElement("svg",{className:this.style[this.state.style],width:"100",height:"2"},o.a.createElement("path",{d:"M 1 1 L 100 1",strokeWidth:"2",stroke:"#0066aa"}))),o.a.createElement("div",{className:"dropdown-menu"},Object.keys(this.style).map((function(t){return o.a.createElement("div",{key:t,style:{padding:15},className:"button box_flex",onClick:function(){e.onChangeStyle(t)}},o.a.createElement("svg",{width:"100",height:"2",className:e.style[t]},o.a.createElement("path",{d:"M 1 1 L 100 1",strokeWidth:"2",stroke:"#0066aa"})))}))))),o.a.createElement("div",{className:"link_ctl_item"},o.a.createElement("div",{className:"box_line link_ctl_title"},lang("Label")),o.a.createElement("input",{className:"link_ctl_input",type:"text",value:this.state.label,onChange:function(t){e.onChangeLabel(t.target.value)}})),o.a.createElement("div",{className:"link_ctl_item"},o.a.createElement("div",{className:"box_line link_ctl_title"},lang("Width")),o.a.createElement("input",{className:"link_ctl_input",type:"number",value:this.state.width,onChange:function(t){e.onChangeWidth(t.target.value)}})),o.a.createElement("div",{className:"link_ctl_item"},o.a.createElement("div",{className:"box_line link_ctl_title"},lang("Font Size")),o.a.createElement("input",{className:"link_ctl_input",type:"number",value:this.state.fontsize,onChange:function(t){e.onChangeFontSize(t.target.value)}})),o.a.createElement("div",{style:{margin:"auto 5px auto auto"}},o.a.createElement("button",{className:"button btn btn-xs btn-primary",onClick:function(){e.onApply()},style:{margin:"5px",width:60}},lang("Apply")),o.a.createElement("button",{className:"button btn btn-xs btn-danger",onClick:function(){e.onCancel()},style:{margin:"5px",width:60}},lang("Cancel"))))),o.a.createElement(l.a,null))}},{key:"modal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"show";"hide"==t?(this.setState({show:!1},(function(){document.getElementById("alert_container").style.top="0px",document.getElementById("notification_container").style.top="30px"})),document.querySelectorAll(".lable_draggable").forEach((function(e){e.classList.remove("lable_draggable")})),App.topControl=!1):(this.setState({show:!0},(function(){var t=e.dom.clientHeight;document.getElementById("alert_container").style.top=t+"px",document.getElementById("notification_container").style.top=t+30+"px"})),App.topControl=!0)}},{key:"onApply",value:function(){var e=this;if(""!=this.labPath){var t=this.connection.id,n=null,a=null,o=null;return-1!=t.search("iface")?(n=t.replace("iface:node","").replace(/:.*/,""),a=t.replace(/.*:/,"")):o=t.replace("network_id:",""),axios.request({url:"/api/labs/session/interfaces/style",method:"post",data:{node_id:n,interface_id:a,network_id:o,path:this.labPath,style:this.state.style,linkstyle:this.state.type,color:this.state.color,label:this.state.label,width:this.state.width,fontsize:this.state.fontsize,linkcfg:JSON.stringify(this.getLinkCfg()),dstpos:JSON.stringify(this.dstpos),srcpos:JSON.stringify(this.srcpos),labelpos:JSON.stringify(this.labelpos)}}).then((function(t){"success"==(t=t.data).status?(e.connection=null,e.modal("hide"),App.topology.updateData(t.update)):(App.topology.printTopology(),error_handle(t))})).catch((function(e){App.topology.printTopology(),console.log(e),error_handle(e)}))}}},{key:"onCancel",value:function(){this.modal("hide"),App.topology.printTopology()}},{key:"onChangeColor",value:function(e){if(this.setState({color:e}),""==e&&(e="#0066aa"),this.connection){var t=this.connection.getPaintStyle();t.stroke=e,this.connection.setPaintStyle(t);var n=this.connection.getOverlays();for(var a in n)if("__label"!=a){var o=n[a],i=$(o.getLabel());i.length>0&&(i.css("color",e),i.css("border-color",e),o.setLabel(i[0].outerHTML))}var l=$(this.connection.getLabel());l.length>0&&(l.css("color",e),l.css("border-color",e),this.connection.setLabel(l[0].outerHTML))}}},{key:"onChangeStyle",value:function(e){var t=get(this.style[e],"");if(this.setState({style:e}),this.connection){var n=this.connection.getClass(),a=n.replace(/\s?border_style_([a-z]+)/g,"");a=a+" "+t,this.connection.removeClass(n),this.connection.addClass(a)}}},{key:"onChangeLabel",value:function(e){if(this.setState({label:e}),this.connection){var t=$(this.connection.getLabel());t.length>0&&(t.text(e),""==e?t.addClass("label_hide"):t.removeClass("label_hide")),this.connection.setLabel(t[0].outerHTML)}}},{key:"onChangeWidth",value:function(e){if(this.setState({width:e}),this.connection){""==e&&(e=2);var t=this.connection.getPaintStyle();t.strokeWidth=e,this.connection.setPaintStyle(t)}}},{key:"onChangeFontSize",value:function(e){if(this.setState({fontsize:e}),this.connection){var t=this.connection.getOverlays();for(var n in t)if("__label"!=n){var a=t[n],o=$(a.getLabel());o.length>0&&(""==e||0==e?o.css("font-size",""):o.css("font-size",e+"px"),a.setLabel(o[0].outerHTML))}var i=$(this.connection.getLabel());i.length>0&&(""==e||0==e?i.css("font-size",""):i.css("font-size",e+"px"),this.connection.setLabel(i[0].outerHTML)),this.connection.fontsize=e}}},{key:"getLinkCfg",value:function(){var e={};switch(this.state.type){case"Straight":""!==this.state.stub&&(e.stub=Number(this.state.stub));break;case"Bezier":""!==this.state.curviness&&(e.curviness=Number(this.state.curviness));break;case"Flowchart":""!==this.state.stub&&(e.stub=Number(this.state.stub)),""!==this.state.midpoint&&(e.midpoint=Number(this.state.midpoint)),""!==this.state.cornerRadius&&(e.cornerRadius=Number(this.state.cornerRadius));break;case"StateMachine":""!==this.state.curviness&&(e.curviness=Number(this.state.curviness))}return e}},{key:"updateType",value:function(){this.connection&&(this.connection.setConnector([this.state.type,this.getLinkCfg()]),"Flowchart"!=this.state.type&&"Straight"!=this.state.type||(this.connection.connector.stub=this.state.stub),"Flowchart"==this.state.type&&(this.connection.connector.midpoint=this.state.midpoint),"StateMachine"==this.state.type&&(this.connection.connector.curviness=this.state.curviness))}},{key:"setConnection",value:function(e){this.connection=e;var t=e.getConnector().type,n="";"Straight"!=t&&"Flowchart"!=t||(n=e.connector.stub?e.connector.stub:"");var a="";"Bezier"==t&&(a=e.connector.getCurviness()),"StateMachine"==t&&(a=get(e.connector.curviness,""));var o="0.5",i="";if("Flowchart"==t){o=get(e.connector.midpoint,.5);var l=e.connector.getSegments().find((function(e){return"Arc"==e.type}));l&&(i=l.radius)}var s=e.getPaintStyle(),r=get(s.stroke,""),c=get(s.strokeWidth,2),u=get(this.connection.fontsize,""),d=e.getClass(),p=/.*border_style_([a-z]+).*/.exec(d);if(p)h=p[1];else var h="";y=null==(y=e.getLabel())?"":$("<div>".concat(y,"</div>")).text(),console.log({type:t,color:r,style:h,label:y,stub:n,curviness:a,midpoint:o,cornerRadius:i}),this.setState({type:t,color:r,style:h,label:y,stub:n,curviness:a,midpoint:o,cornerRadius:i,width:c,fontsize:u}),this.original={type:t,color:r,style:h,label:y,stub:n,curviness:a,midpoint:o,cornerRadius:i,width:c,fontsize:u};var f=e.id,m=$(this.connection.getLabel());m.length>0&&(m.text(y),m.addClass("lable_draggable"),m.attr("connect_id",f),this.connection.setLabel(m[0].outerHTML));var b=this.connection.getOverlays();for(var g in b)if("__label"!=g){var y,v=b[g];(y=$(v.getLabel())).length>0&&(y.addClass("lable_draggable"),y.attr("connect_id",f),v.setLabel(y[0].outerHTML),"src"==y.attr("position")?this.srcLabel=v:"dst"==y.attr("position")&&(this.dstLabel=v))}if(isset(App.topology.links[this.connection.id])){var _=App.topology.links[this.connection.id].source.interface.get("style",{});try{this.srcpos=JSON.parse(_.srcpos)}catch(e){this.srcpos={}}try{this.dstpos=JSON.parse(_.dstpos)}catch(e){this.dstpos={}}try{this.labelpos=JSON.parse(_.labelpos)}catch(e){this.labelpos={}}}}},{key:"componentDidMount",value:function(){var t=this;$(document).on("click",".action-connectedit",(function(e){App.topControl?showLog(lang("Apply your change first"),"error"):(t.setConnection(window.connToDel),$("#context-menu").remove(),t.modal())})),$(document).on("click","#color".concat(this.id),(function(e){e.stopPropagation()})),e.hideLinkControl=function(){t.connection=null,t.modal("hide")},e.isEdittingLink=function(){return t.state.show},$(document).on("mousedown",".lable_draggable",(function(e){t.moveControl.setObject(e.target)})),$(document).on("contextmenu",".lable_draggable",(function(e){var n=e.target,a=n.style.transform,i=/.*rotate\(([\d\+\-]+)deg\).*/.exec(a);if(i)var l=i[1];else l=0;var s=makeId();App.ContextMenu.show(event),App.ContextMenu.setMenu(o.a.createElement("div",{key:s,className:"box_shadow box_border",style:{background:"white",color:"#0066aa",borderRadius:2,padding:5}},o.a.createElement("div",{className:"button",onClick:function(){n.style.transform="",n.classList.contains("link_label")?(t.labelpos.x=0,t.labelpos.y=0,t.labelpos.rotate=0):n.classList.contains("node_interface")&&"src"==n.getAttribute("position")?(t.srcpos.x=0,t.srcpos.y=0,t.srcpos.rotate=0):n.classList.contains("node_interface")&&"dst"==n.getAttribute("position")&&(t.dstpos.x=0,t.dstpos.y=0,t.dstpos.rotate=0),t.applyObjectToConnection(n)},style:{marginBottom:10}},o.a.createElement("b",null,"Reset Position")),o.a.createElement("div",{className:"box_flex",onClick:function(e){App.ContextMenu.show()},style:{marginBottom:10,fontWeight:"bold"}},o.a.createElement("div",null,"Rotate: "),o.a.createElement("input",{style:{padding:"0px 5px",borderRadius:3,border:"solid thin",width:100},type:"number",defaultValue:l,onChange:function(e){var a=e.target.value;n.classList.contains("link_label")?t.labelpos.rotate=a:n.classList.contains("node_interface")&&"src"==n.getAttribute("position")?t.srcpos.rotate=a:n.classList.contains("node_interface")&&"dst"==n.getAttribute("position")&&(t.dstpos.rotate=a);var o=n.style.transform,i=/.*translate\(([\d\+\-]+)px, ([\d\+\-]+)px\).*/.exec(o);if(i)var l={x:Number(i[1]),y:Number(i[2])};else l={x:0,y:0};l.rotate=a,console.log(l);var s="";void 0!==l.x&&void 0!==l.y&&(s="translate(".concat(l.x,"px, ").concat(l.y,"px)")),1==l.hide&&(hideClass="label_hide"),void 0!==l.rotate&&(s+=" rotate(".concat(l.rotate,"deg)")),n.style.transform=s,t.applyObjectToConnection(n)}})),n.classList.contains("label_hide")?o.a.createElement("div",{className:"button",onClick:function(){n.classList.remove("label_hide"),n.classList.contains("link_label")?t.labelpos.hide=!1:n.classList.contains("node_interface")&&"src"==n.getAttribute("position")?t.srcpos.hide=!1:n.classList.contains("node_interface")&&"dst"==n.getAttribute("position")&&(t.dstpos.hide=!1),t.applyObjectToConnection(n)}},o.a.createElement("b",null,"Show")):o.a.createElement("div",{className:"button",onClick:function(){n.classList.add("label_hide"),n.classList.contains("link_label")?t.labelpos.hide=!0:n.classList.contains("node_interface")&&"src"==n.getAttribute("position")?t.srcpos.hide=!0:n.classList.contains("node_interface")&&"dst"==n.getAttribute("position")&&(t.dstpos.hide=!0),t.applyObjectToConnection(n)}},o.a.createElement("b",null,"Hide")))),e.stopPropagation(),e.preventDefault()}))}}])&&u(a.prototype,r),c&&u(a,c),n}(a.Component);t.a=f}).call(this,n(1))},88:function(e,t,n){"use strict";(function(e){var a=n(0),o=n.n(a),i=n(46);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){return(s="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(e){return l(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":l(e)})(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=p(this,h(n).call(this,e))).type={Straight:"Straight",Bezier:"Bezier",Flowchart:"Flowchart",StateMachine:"State Machine"},t.style={solid:"line_style_solid",dashed:"line_style_dashed",dotted:"line_style_dotted",dotdash:"line_style_dotdash"},t.syms={"":"",arrow:"Arrow",dot:"Dot",square:"Square"},t.id=makeId(),t.state={linestyle:"Straight",color:"#0066aa",paintstyle:"solid",label:"",startsym:"",endsym:"",width:"",stub:"",curviness:"",midpoint:.5,cornerRadius:"",show:!1},t.original={},t.lines={},t.connection=null,t.labPath=$("#lab-viewport").attr("data-path"),t.labViewWidth=$("#lab-viewport").width(),t.labViewHeight=$("#lab-viewport").height(),t}var a,l,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),a=n,(l=[{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement("style",null,"\n                .line_style_solid{\n                    stroke-dasharray: none;\n                }\n\n                .line_style_dashed{\n                    stroke-dasharray: 5,5;\n                }\n\n                .line_style_dotted{\n                    stroke-linecap: round;\n                    stroke-dasharray: 1,5;\n                }\n\n                .line_style_dotdash{\n                    stroke-linecap: round;\n                    stroke-dasharray: 1,5,10,5;\n                }\n\n                .line_ctl_frame{\n                    background-color: white;\n                    position: fixed;\n                    top: 0px;\n                    left: 0px;\n                    right: 0px;\n                    z-index: 2000;\n                    display: none;\n                    padding: 5px 5px 10px 5px;\n                    transition: all 0.2s ease-out;\n                }\n                .line_ctl_input{\n                    height:30px;\n                    width: 100px;\n                    margin-top: 5px;\n                    border: solid thin darkgray;\n                    border-radius: 4px;\n                    padding: 5px;\n                    text-shadow: white -1px 0px, white 0px 1px, white 1px 0px, white 0px -1px;\n                }\n                .line_ctl_item{\n                    margin: 5px;\n                }\n\n                .line_ctl_item .line_ctl_title{\n                    color: #346789;\n                    font-weight:bold;\n                }\n                #lab-viewport .line_label {\n                    background-color: #e6f5ff;\n                    border: 2px solid #346789;\n                    border-radius: 2px;\n                    font-family: helvetica;\n                    font-size: 0.8em;\n                    font-weight: bold;\n                    padding: 0px 2px 0px 2px;\n                }\n\n                #lab-viewport svg:not(:root) {\n                    overflow: unset;\n                }\n\n                .jtk-connector path{\n                    cursor: pointer;\n                }\n\n                \n\n                \n\n            "),o.a.createElement("div",{ref:function(t){return e.dom=t},className:"box_shadow line_ctl_frame",style:{display:this.state.show?"block":"none"}},o.a.createElement("div",{className:"box_flex"},o.a.createElement("div",{className:"line_ctl_item"},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("Type")),o.a.createElement("select",{className:"line_ctl_input",value:this.state.linestyle,onChange:function(t){e.setState({linestyle:t.target.value},(function(){e.applyType(e.connection,e.state.linestyle,e.getlineCfg())}))}},Object.keys(this.type).map((function(t){return o.a.createElement("option",{key:t,value:t},e.type[t])})))),o.a.createElement("div",{className:"line_ctl_item",style:{display:"Straight"==this.state.linestyle||"Flowchart"==this.state.linestyle?"block":"none"}},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("Stub")),o.a.createElement("input",{className:"line_ctl_input",type:"number",value:this.state.stub,onChange:function(t){e.setState({stub:t.target.value},(function(){e.applyType(e.connection,e.state.linestyle,e.getlineCfg())}))}})),o.a.createElement("div",{className:"line_ctl_item",style:{display:"Bezier"==this.state.linestyle||"StateMachine"==this.state.linestyle?"block":"none"}},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("Curviness")),o.a.createElement("input",{className:"line_ctl_input",step:"5",type:"number",value:this.state.curviness,onChange:function(t){e.setState({curviness:t.target.value},(function(){e.applyType(e.connection,e.state.linestyle,e.getlineCfg())}))}})),o.a.createElement("div",{className:"line_ctl_item",style:{display:"Flowchart"==this.state.linestyle?"block":"none"}},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("Round")),o.a.createElement("input",{className:"line_ctl_input",type:"number",value:this.state.cornerRadius,onChange:function(t){e.setState({cornerRadius:t.target.value},(function(){e.applyType(e.connection,e.state.linestyle,e.getlineCfg())}))}})),o.a.createElement("div",{className:"line_ctl_item",style:{display:"Flowchart"==this.state.linestyle?"block":"none"}},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("Mid Point")),o.a.createElement("div",{className:"line_ctl_input box_flex",style:{width:150}},o.a.createElement("input",{style:{width:"100%"},type:"range",name:"vol",min:"0",max:"100",value:100*this.state.midpoint,onChange:function(t){e.setState({midpoint:t.target.value/100},(function(){e.applyType(e.connection,e.state.linestyle,e.getlineCfg())}))}}))),o.a.createElement("div",{className:"line_ctl_item"},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("Width")),o.a.createElement("input",{className:"line_ctl_input",type:"number",value:this.state.width,onChange:function(t){e.onChangeWidth(t.target.value)}})),o.a.createElement("div",{className:"line_ctl_item"},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("Color")),o.a.createElement("div",{className:"dropdown"},o.a.createElement("input",{value:this.state.color,style:{backgroundColor:this.state.color},onChange:function(t){e.onChangeColor(t.target.value)},className:"dropdown-toggle line_ctl_input","data-toggle":"dropdown"}),o.a.createElement("div",{className:"dropdown-menu",id:"color".concat(this.id),style:{padding:0}},o.a.createElement(i.SketchPicker,{color:this.state.color,onChangeComplete:function(t){t=t.rgb;var n="rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")");e.onChangeColor(n)}})))),o.a.createElement("div",{className:"line_ctl_item"},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("Style")),o.a.createElement("div",{className:"dropdown"},o.a.createElement("div",{className:"dropdown-toggle box_flex line_ctl_input","data-toggle":"dropdown"},o.a.createElement("svg",{className:this.style[this.state.paintstyle],width:"100",height:"2"},o.a.createElement("path",{d:"M 1 1 L 100 1",strokeWidth:"2",stroke:"#0066aa"}))),o.a.createElement("div",{className:"dropdown-menu"},Object.keys(this.style).map((function(t){return o.a.createElement("div",{key:t,style:{padding:15},className:"button box_flex",onClick:function(){e.onChangeStyle(t)}},o.a.createElement("svg",{width:"100",height:"2",className:e.style[t]},o.a.createElement("path",{d:"M 1 1 L 100 1",strokeWidth:"2",stroke:"#0066aa"})))}))))),o.a.createElement("div",{className:"line_ctl_item"},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("Start Symbol")),o.a.createElement("div",{className:"dropdown"},o.a.createElement("div",{className:"dropdown-toggle box_flex line_ctl_input","data-toggle":"dropdown"},o.a.createElement("svg",{width:"100",height:"10"},o.a.createElement("path",{d:"M 10 5 L 80 5",strokeWidth:"2",stroke:"#0066aa",markerStart:"url(#".concat(this.state.startsym,"0")}))),o.a.createElement("div",{className:"dropdown-menu"},Object.keys(this.syms).map((function(t){return o.a.createElement("div",{key:t,style:{padding:15},className:"button box_flex",onClick:function(){e.onChangeStartSym(t)}},o.a.createElement("svg",{width:"100",height:"10"},o.a.createElement("path",{d:"M 10 5 L 80 5",strokeWidth:"2",stroke:"#0066aa",markerStart:"url(#".concat(t,"0")})))}))))),o.a.createElement("div",{className:"line_ctl_item"},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("End Symbol")),o.a.createElement("div",{className:"dropdown"},o.a.createElement("div",{className:"dropdown-toggle box_flex line_ctl_input","data-toggle":"dropdown"},o.a.createElement("svg",{width:"100",height:"10"},o.a.createElement("path",{d:"M 10 5 L 80 5",strokeWidth:"2",stroke:"#0066aa",markerEnd:"url(#".concat(this.state.endsym,"0")}))),o.a.createElement("div",{className:"dropdown-menu"},Object.keys(this.syms).map((function(t){return o.a.createElement("div",{key:t,style:{padding:15},className:"button box_flex",onClick:function(){e.onChangeEndSym(t)}},o.a.createElement("svg",{width:"100",height:"10"},o.a.createElement("path",{d:"M 10 5 L 80 5",stroke:"#0066aa",strokeWidth:"2",markerEnd:"url(#".concat(t,"0")})))}))))),o.a.createElement("div",{className:"line_ctl_item"},o.a.createElement("div",{className:"box_line line_ctl_title"},lang("Label")),o.a.createElement("input",{className:"line_ctl_input",type:"text",value:this.state.label,onChange:function(t){e.onChangeLabel(t.target.value)}})),o.a.createElement("svg",{height:"0",width:"0",fill:"#0066aa"},o.a.createElement("defs",null,o.a.createElement("marker",{id:"dot0",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"4",markerHeight:"4",orient:"auto-start-reverse"},o.a.createElement("circle",{cx:"5",cy:"5",r:"5"})),o.a.createElement("marker",{id:"square0",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"4",markerHeight:"4",orient:"auto-start-reverse"},o.a.createElement("rect",{width:"10",height:"10"})),o.a.createElement("marker",{id:"arrow0",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5",orient:"auto-start-reverse"},o.a.createElement("path",{d:"M 0 10 L 10 5 L 0 0 L 3 5 z"})))),o.a.createElement("div",{style:{margin:"auto 0px auto auto"}},o.a.createElement("button",{className:"button btn btn-xs btn-primary",onClick:function(){e.onApply()},style:{margin:"5px",width:60}},lang("Apply")),o.a.createElement("button",{className:"button btn btn-xs btn-danger",onClick:function(){e.onCancel()},style:{margin:"5px",width:60}},lang("Cancel"))))))}},{key:"modal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"show";"hide"==t?(this.setState({show:!1},(function(){document.getElementById("alert_container").style.top="0px",document.getElementById("notification_container").style.top="30px"})),App.topControl=!1):(this.setState({show:!0},(function(){var t=e.dom.clientHeight;document.getElementById("alert_container").style.top=t+"px",document.getElementById("notification_container").style.top=t+30+"px"})),App.topControl=!0)}},{key:"onApply",value:function(){if(""!=this.labPath){var e=this.connection.id,t={id:e=e.replace(/\D/g,""),linestyle:this.state.linestyle,paintstyle:this.state.paintstyle,color:this.state.color,label:this.state.label,width:this.state.width,endsym:this.state.endsym,startsym:this.state.startsym,linecfg:JSON.stringify(this.getlineCfg())};this.editLine(t),this.modal("hide")}}},{key:"onCancel",value:function(){this.modal("hide"),App.topology.printTopology()}},{key:"onChangeColor",value:function(e){this.setState({color:e}),""==e&&(e="#0066aa"),this.applyColor(this.connection,e)}},{key:"applyColor",value:function(e,t){if(e){var n=e.getPaintStyle();n.stroke=t,e.setPaintStyle(n);var a="color:".concat(t),o="border-color:".concat(t),i=e.getOverlays();for(var l in i)if("__label"!=l){var s=i[l],r=$("<div>".concat(s.getLabel(),"</div>")).text();""!=r&&s.setLabel('<div class="node_interface" style="'.concat(a,";").concat(o,'">').concat(r,"</div>"))}""!=this.state.label&&e.setLabel('<div style="'.concat(a,"; ").concat(o,'" class="line_label">').concat(this.state.label,"</div>"))}}},{key:"drawsym",value:function(e,t,n){switch(isset(n)||(n="inherit"),e){case"dot":return'<marker style="fill:'.concat(n,'; stroke-width:0" id="dot').concat(t,'" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><circle cx="5" cy="5" r="5"/></marker>');case"square":return'<marker style="fill:'.concat(n,'; stroke-width:0" id="square').concat(t,'" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><rect width="10" height="10"/></marker>');case"arrow":return'<marker style="fill:'.concat(n,'; stroke-width:0" id="arrow').concat(t,'" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5" orient="auto-start-reverse"><path d="M 0 10 L 10 5 L 0 0 L 3 5 z" /></marker>');default:return""}}},{key:"onChangeStartSym",value:function(e){this.setState({startsym:e}),this.applySym(this.connection,this.state.color,this.state.endsym,e)}},{key:"onChangeEndSym",value:function(e){this.setState({endsym:e}),this.applySym(this.connection,this.state.color,e,this.state.startsym)}},{key:"applySym",value:function(e,t,n,a){if(e){var o=e.id;o=o.replace(/\D/g,""),$("#sym".concat(o)).remove();var i='<div id="sym'.concat(o,'">\n        <svg height="0px"><defs>\n            ').concat(this.drawsym(a,o,t),"\n            ").concat(this.drawsym(n,o,t),"\n        </defs></svg>\n        <style>\n            .sym_").concat(o," path {\n                marker-start: url(#").concat(a+o,");\n                marker-end: url(#").concat(n+o,");\n            }\n        </style>\n        </div>");$("body").append(i);var l=e.getClass(),s=l.replace(/\s?sym_(\d+)/g,"");s=s+" "+"sym_".concat(o),e.removeClass(l),e.addClass(s)}}},{key:"onChangeWidth",value:function(e){e>=0&&(this.setState({width:e}),this.applyWidth(this.connection,e))}},{key:"applyWidth",value:function(e,t){if(e){""===t&&(t=2);var n=e.getPaintStyle();n.strokeWidth=t,e.setPaintStyle(n)}}},{key:"onChangeStyle",value:function(e){this.setState({paintstyle:e}),this.applyStyle(this.connection,e)}},{key:"applyStyle",value:function(e,t){if(e){var n=get(this.style[t],""),a=e.getClass(),o=a.replace(/\s?line_style_([a-z]+)/g,"");o=o+" "+n,e.removeClass(a),e.addClass(o)}}},{key:"onChangeLabel",value:function(e){this.setState({label:e}),this.applyLabel(this.connection,e,this.state.color)}},{key:"applyLabel",value:function(e,t,n){if(n&&""!=n)a="color:".concat(n),o="border-color:".concat(n);else var a="",o="";e&&(""==t?e.setLabel(""):e.setLabel('<div style="'.concat(a,"; ").concat(o,'" class="line_label">').concat(t,"</div>")))}},{key:"getlineCfg",value:function(){var e={};switch(this.state.linestyle){case"Straight":""!==this.state.stub&&(e.stub=Number(this.state.stub));break;case"Bezier":""!==this.state.curviness&&(e.curviness=Number(this.state.curviness));break;case"Flowchart":""!==this.state.stub&&(e.stub=Number(this.state.stub)),""!==this.state.midpoint&&(e.midpoint=Number(this.state.midpoint)),""!==this.state.cornerRadius&&(e.cornerRadius=Number(this.state.cornerRadius));break;case"StateMachine":""!==this.state.curviness&&(e.curviness=Number(this.state.curviness))}return e}},{key:"applyType",value:function(e,t,n){e&&e.setConnector([t,n])}},{key:"setConnection",value:function(e){this.connection=e;var t=e.id.replace(/\D/g,""),n=window.topology.lines[t];if(n){var a={stub:"",curviness:"",midpoint:.5,cornerRadius:""};try{a=c({},a,{},JSON.parse(n.linecfg))}catch(e){}var o=c({linestyle:get(n.linestyle,"Straight"),paintstyle:get(n.paintstyle,"solid"),color:get(n.color,""),label:get(n.label,""),width:get(n.width,""),endsym:get(n.endsym,""),startsym:get(n.startsym,"")},a);this.setState(o),this.original=o}else showLog("Line not found","error")}},{key:"createLine",value:function(e){var t=makeId();$("#context-menu").remove(),this.original=this.state;var n=1;"function"==typeof getZoomLab&&(n=getZoomLab()/100);var a={id:t,linestyle:this.state.linestyle,paintstyle:this.state.paintstyle,color:this.state.color,label:this.state.label,width:this.state.width,endsym:this.state.endsym,startsym:this.state.startsym,linecfg:JSON.stringify(this.getlineCfg()),x1:e.clientX/n,x2:e.clientX/n+200,y1:e.clientY/n,y2:e.clientY/n};this.connection=this.drawline(a),lab_topology.draggable($(".customShape"),{grid:[3,3],start:ObjectStartDrag,stop:ObjectPosUpdate}),this.addLine(a)}},{key:"drawline",value:function(e){if(isset(e.x1)&&isset(e.x2)&&isset(e.y1)&&isset(e.y2)){var t=$("#lab-viewport"),n=e.id,a='<div id="startLine'.concat(n,'" style="z-index:12000; position: absolute; width:20px; height: 20px; cursor: move; top: ').concat(e.y1,"px; left:").concat(e.x1,'px" class="customShape linePoint"><a href="#"></a></div>');a+='<div id="endLine'.concat(n,'" style="z-index:12000; position: absolute; width:20px; height: 20px; cursor: move; top: ').concat(e.y2,"px; left:").concat(e.x2,'px" class="customShape linePoint"><a href="#"></a></div>'),t.prepend(a);var o=lab_topology.addEndpoint("startLine"+n),i=lab_topology.addEndpoint("endLine"+n),l=lab_topology.connect({source:o,target:i,paintStyle:{strokeWidth:2,stroke:"#0066aa"}});return l.id="line".concat(n),e.linecfg&&e.linestyle&&this.applyType(l,e.linestyle,JSON.parse(e.linecfg)),e.color&&this.applyColor(l,e.color),e.label&&this.applyLabel(l,e.label,e.color),e.paintstyle&&this.applyStyle(l,e.paintstyle),isset(e.width)&&this.applyWidth(l,e.width),isset(e.width)&&this.applySym(l,e.color,e.endsym,e.startsym),l.bind("click",(function(e,t){t.stopPropagation(),$("#startLine".concat(n,", #endLine").concat(n)).addClass("ui-selected"),updateFreeSelect()})),l}}},{key:"addLine",value:function(e){var t=this;if(1!=LOCK)return axios.request({url:"/api/labs/session/line/add",method:"post",data:{data:e}}).then((function(e){"success"==(e=e.data).status?App.topology.updateData(e.update):(t.onCancel(),App.topology.printTopology(),error_handle(e))})).catch((function(e){console.log(e),error_handle(e)}))}},{key:"editLine",value:function(e){var t=this;if(1!=LOCK)return axios.request({url:"/api/labs/session/line/edit",method:"post",data:{data:e}}).then((function(e){"success"==(e=e.data).status?App.topology.updateData(e.update):(t.onCancel(),App.topology.printTopology(),error_handle(e))})).catch((function(e){console.log(e),error_handle(e)}))}},{key:"getLines",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return axios.request({url:"/api/labs/session/line",method:"get"}).then((function(n){if("success"==(n=n.data).status){if(e.lines=n.message,!t)return;for(var a in e.lines){var o=e.lines[a];e.drawline(o)}0==LOCK&&lab_topology.draggable($(".customShape"),{grid:[3,3],start:ObjectStartDrag,stop:ObjectPosUpdate})}else error_handle(n)})).catch((function(e){console.log(e),error_handle(e)}))}},{key:"updatePostionLines",value:function(e){return 0==e.length||1==LOCK?Promise.resolve():axios.request({url:"/api/labs/session/line/position",method:"post",data:{data:e}}).then((function(e){"success"==(e=e.data).status?App.topology.updateData(e.update):(error_handle(e),App.topology.printTopology())})).catch((function(e){console.log(e),error_handle(e)}))}},{key:"deleteLine",value:function(e){return axios.request({url:"/api/labs/session/line/delete",method:"post",data:{id:e}}).then((function(e){"success"==(e=e.data).status?(App.topology.updateData(e.update),App.topology.printTopology()):(error_handle(e),App.topology.printTopology())})).catch((function(e){console.log(e),error_handle(e)}))}},{key:"moveSelectPoint",value:function(e){var t=this;if(!this.moveInteval){var n=$(".node_frame.ui-selected, node_frame.ui-selecting, .network_frame.ui-selected,.network_ui-selecting,.customShape.ui-selected,.customShape.ui-selecting");0!=n.length&&($("#lab-viewport").css("pointer-events","none"),this.moveInteval=setInterval((function(){return t.stepPoint(n,e)}),100))}}},{key:"stopSelectPoint",value:function(e){var t=$(".node_frame.ui-selected, node_frame.ui-selecting, .network_frame.ui-selected,.network_ui-selecting,.customShape.ui-selected,.customShape.ui-selecting");0!=t.length&&(this.moveInteval&&(clearInterval(this.moveInteval),this.moveInteval=null),this.stopTimeout&&(clearTimeout(this.stopTimeout),this.stopTimeout=null),this.stopTimeout=setTimeout((function(){window.moveCount=t.length-1,ObjectPosUpdate(e),window.dragstop=0,$("#lab-viewport").css("pointer-events","auto")}),500))}},{key:"stepPoint",value:function(e,t){var n=this;39==t&&(e.each((function(e,t){var a=Number(t.style.left.replace(/\D/g,""))+1;a>n.labViewWidth&&(a=n.labViewWidth),t.style.left=a+"px"})),lab_topology.repaintEverything()),37==t&&(e.each((function(e,t){var n=Number(t.style.left.replace(/\D/g,""))-1;n<0&&(n=0),t.style.left=n+"px"})),lab_topology.repaintEverything()),38==t&&(e.each((function(e,t){var n=Number(t.style.top.replace(/\D/g,""))-1;n<0&&(n=0),t.style.top=n+"px"})),lab_topology.repaintEverything()),40==t&&(e.each((function(e,t){var a=Number(t.style.top.replace(/\D/g,""))+1;a>n.labViewHeight&&(a=n.labViewHeight),t.style.top=a+"px"})),lab_topology.repaintEverything())}},{key:"componentDidMount",value:function(){var t=this;$(document).on("contextmenu",".linePoint",(function(e){if(1!=LOCK){var t=e.currentTarget.id.replace(/\D/g,"");window.connToDel=lab_topology.getConnections().find((function(e){return e.id=="line".concat(t)})),window.connToDel&&"user"!=ROLE&&1!=LOCK&&(printContextMenu("Connection",'<li><a class="action-lineedit" href="javascript:void(0)"><i class="glyphicon glyphicon-edit"></i> Edit</a></li><li><a class="action-linedelete" href="javascript:void(0)"><i class="glyphicon glyphicon-trash"></i> Delete</a></li>',e),e.stopPropagation(),e.preventDefault())}})),$(document).on("click",".action-lineedit",(function(e){1!=LOCK&&(App.topControl?showLog(lang("Apply your change first"),"error"):(t.setConnection(window.connToDel),$("#context-menu").remove(),t.modal()))})),$(document).on("click",".action-linedelete",(function(e){if(1!=LOCK)if(App.topControl)showLog(lang("Apply your change first"),"error");else{var n=window.connToDel.id;n=n.replace(/\D/g,""),t.deleteLine(n),$("#context-menu").remove()}})),$(document).on("click",".action-lineadd",(function(e){1!=LOCK&&(App.topControl?showLog(lang("Apply your change first"),"error"):(t.createLine(e),$("#context-menu").remove(),t.modal()))})),$(document).on("click","#color".concat(this.id),(function(e){e.stopPropagation()})),e.hideLineControl=function(){t.connection=null,t.modal("hide")},e.isEdittingLine=function(){return t.state.show},e.setLinePosition=function(e){return t.updatePostionLines(e)},e.getLines=this.getLines.bind(this),$(document).on("keydown",(function(e){var n=e.keyCode;37!=n&&38!=n&&39!=n&&40!=n||t.moveSelectPoint(n)})),$(document).on("keyup",(function(e){var n=e.keyCode;37!=n&&38!=n&&39!=n&&40!=n||t.stopSelectPoint(e)}))}}])&&d(a.prototype,l),s&&d(a,s),n}(a.Component);t.a=m}).call(this,n(1))}}]);